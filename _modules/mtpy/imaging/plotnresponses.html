
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mtpy.imaging.plotnresponses &#8212; mtpy 1.01.01 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for mtpy.imaging.plotnresponses</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">plots multiple MT responses simultaneously</span>

<span class="sd">Created on Thu May 30 17:02:39 2013</span>
<span class="sd">@author: jpeacock-pr</span>

<span class="sd">YG: the code there is massey, todo may need to rewrite it sometime</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># ============================================================================</span>

<span class="kn">import</span> <span class="nn">matplotlib.colorbar</span> <span class="k">as</span> <span class="nn">mcb</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MultipleLocator</span>

<span class="kn">import</span> <span class="nn">mtpy.imaging.mtcolors</span> <span class="k">as</span> <span class="nn">mtcl</span>
<span class="kn">import</span> <span class="nn">mtpy.imaging.mtplottools</span> <span class="k">as</span> <span class="nn">mtpl</span>
<span class="kn">from</span> <span class="nn">mtpy.analysis.pt</span> <span class="k">import</span> <span class="n">PhaseTensor</span>
<span class="kn">from</span> <span class="nn">mtpy.analysis.zinvariants</span> <span class="k">import</span> <span class="n">Zinvariants</span>


<span class="c1"># reload(mtpl)</span>

<span class="c1"># ============================================================================</span>
<span class="kn">from</span> <span class="nn">mtpy.core.mt</span> <span class="k">import</span> <span class="n">MT</span>


<div class="viewcode-block" id="PlotMultipleResponses"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotnresponses.PlotMultipleResponses">[docs]</a><span class="k">class</span> <span class="nc">PlotMultipleResponses</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">PlotSettings</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    plots multiple MT responses simultaneously either in single plots or in</span>
<span class="sd">    one plot of sub-figures or in a single plot with subfigures for each</span>
<span class="sd">    component.</span>

<span class="sd">    expecting only one type of input --&gt; can be:</span>
<span class="sd">        **fn_list** : list of filenames to plot</span>

<span class="sd">         **z_object_list** : list of mtpy.core.z.Z objects</span>

<span class="sd">         **res_object_list** : list of mtpy.imaging.mtplot.ResPhase objects</span>

<span class="sd">         **tipper_object_list** : list of mtpy.imaging.mtplot.Tipper objects</span>

<span class="sd">         **mt_object_list** : list of mtpy.imaging.mtplot.MTplot objects</span>


<span class="sd">    Arguments:</span>
<span class="sd">    ----------</span>
<span class="sd">        **fn_list** : list of filenames to plot</span>
<span class="sd">                     ie. [fn_1, fn_2, ...], *default* is None</span>

<span class="sd">         **z_object_list** : list of mtpy.core.z.Z objects</span>
<span class="sd">                            *default* is None</span>

<span class="sd">         **res_object_list** : list of mtpy.imaging.mtplot.ResPhase objects</span>
<span class="sd">                              *default* is None</span>

<span class="sd">         **tipper_object_list** : list of mtpy.imaging.mtplot.Tipper objects</span>
<span class="sd">                                 *default* is None</span>

<span class="sd">         **mt_object_list** : list of mtpy.imaging.mtplot.MTplot objects</span>
<span class="sd">                             *default* is None</span>

<span class="sd">        **fig_num** : int</span>
<span class="sd">                     figure number</span>
<span class="sd">                     *default* is 1</span>
<span class="sd">        **fig_size** : [width, height] of figure size in inches</span>

<span class="sd">        **rot_z** : float or np.ndarray</span>
<span class="sd">                   rotation angle of impedance tensor (deg or radians),</span>
<span class="sd">                   *Note* : rotaion is clockwise positive</span>
<span class="sd">                   *default* is 0</span>
<span class="sd">                   Can input so each station is rotated at a constant angle or</span>
<span class="sd">                   each period is rotated differently, or both.</span>

<span class="sd">        **plot_num** : [ 1 | 2 | 3 ]</span>
<span class="sd">                        * 1 for just Ex/By and Ey/Bx *default*</span>
<span class="sd">                        * 2 for all 4 components</span>
<span class="sd">                        * 3 for off diagonal plus the determinant</span>

<span class="sd">        **plot_style** : [ &#39;1&#39; | &#39;all&#39; | &#39;compare&#39; ]</span>
<span class="sd">                        determines the plotting style:</span>
<span class="sd">                            * &#39;1&#39; for plotting each station in a different</span>
<span class="sd">                                  figure. *default*</span>

<span class="sd">                            * &#39;all&#39; for plotting each station in a subplot</span>
<span class="sd">                                    all in the same figure</span>

<span class="sd">                            * &#39;compare&#39; for comparing the responses all in</span>
<span class="sd">                                        one plot.  Here the responses are</span>
<span class="sd">                                        colored from dark to light.  This</span>
<span class="sd">                                        plot can get messy if too many stations</span>
<span class="sd">                                        are plotted.</span>


<span class="sd">        **plot_title** : string</span>
<span class="sd">                    title of plot</span>
<span class="sd">                    *default* is station name</span>

<span class="sd">        **plot_tipper** : [ &#39;yri&#39; | &#39;yr&#39; | &#39;yi&#39; | &#39;n&#39; ]</span>
<span class="sd">                          Plots the tipper in a bottom pannel</span>
<span class="sd">                          * &#39;yri&#39;  --&gt; plots the real and imaginar parts</span>
<span class="sd">                          * &#39;yr&#39;   --&gt; plots just the real part</span>
<span class="sd">                          * &#39;yi&#39;   --&gt; plots just the imaginary part</span>

<span class="sd">                          **Note:** the convention is to point towards a</span>
<span class="sd">                          conductor.  Can change this by setting the</span>
<span class="sd">                          parameter arrow_direction = 1.</span>

<span class="sd">        **plot_strike** : [ &#39;y&#39; | 1 | 2 | 3 | &#39;n&#39; ]</span>
<span class="sd">                          Plots the strike angle from different parameters:</span>
<span class="sd">                              * &#39;y&#39;  --&gt; plots strike angle determined from</span>
<span class="sd">                                         the invariants of Weaver et al. [2000]</span>
<span class="sd">                                         and the phase tensor of</span>
<span class="sd">                                         Caldwell et al. [2004], if Tipper is</span>
<span class="sd">                                         plotted the strike of the tipper is</span>
<span class="sd">                                         also plotted.</span>

<span class="sd">                               * 1  --&gt; plots strike angle determined from</span>
<span class="sd">                                        the invariants of Weaver et al. [2000]</span>
<span class="sd">                               * 2  --&gt; plots strike angle determined from</span>
<span class="sd">                                        the phase tensor of</span>
<span class="sd">                                        Caldwell et al. [2004]</span>
<span class="sd">                               * 3  --&gt; plots strike angle determined from</span>
<span class="sd">                                        the tipper</span>
<span class="sd">                               * &#39;n&#39; --&gt; doesn&#39;t plot the strike, *default*</span>

<span class="sd">        **plot_skew** : [ &#39;y&#39; | &#39;n&#39; ]</span>
<span class="sd">                       string for plotting skew angle.  This is plotted in</span>
<span class="sd">                       the same plot as strike angle at the moment.</span>
<span class="sd">                           * &#39;y&#39; for plotting the skew</span>
<span class="sd">                           * &#39;n&#39; for not plotting skew *default*</span>

<span class="sd">        **fig_dpi** : int</span>
<span class="sd">                 dots-per-inch resolution, *default* is 300</span>


<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; import os</span>
<span class="sd">            &gt;&gt;&gt; edipath = r&quot;/home/Edifiles&quot;</span>
<span class="sd">            &gt;&gt;&gt; edilist = [os.path.join(edipath,edi)</span>
<span class="sd">            &gt;&gt;&gt; ...       for edi in os.listdir(edipath)</span>
<span class="sd">            &gt;&gt;&gt; ...       if edi.find(&#39;.edi&#39;)&gt;0]</span>
<span class="sd">            &gt;&gt;&gt; plot each station in a subplot all in one figure with tipper</span>
<span class="sd">            &gt;&gt;&gt; rp1 = mtplot.PlotMultipleResPhase(fn_list=edilist, plotnum=1,</span>
<span class="sd">            &gt;&gt;&gt; ...                                plot_tipper=&#39;yr&#39;,</span>
<span class="sd">            &gt;&gt;&gt; ...                                plot_style=&#39;all&#39;)</span>


<span class="sd">    Attributes:</span>
<span class="sd">    -----------</span>
<span class="sd">        -mt_list         list of mtplot.MTplot objects made from inputs</span>
<span class="sd">        -fignum         figure number for plotting</span>
<span class="sd">        -fig_size       figure size in inches [width, height]</span>
<span class="sd">        -plotnum        plot type, see arguments for details</span>
<span class="sd">        -title          title of the plot, *default* is station name</span>
<span class="sd">        -dpi            Dots-per-inch resolution of plot, *default* is 300</span>
<span class="sd">        -rotz           Rotate impedance tensor by this angle (deg) assuming</span>
<span class="sd">                        that North is 0 and angle is positive clockwise</span>

<span class="sd">        -plot_tipper    string to tell the program to plot tipper arrows or</span>
<span class="sd">                        not, see accepted values above in arguments</span>

<span class="sd">        -plot_strike    string or integer telling the program to plot the</span>
<span class="sd">                        strike angle, see values above in arguments</span>

<span class="sd">        -plot_skew      string to tell the program to plot skew angle.</span>
<span class="sd">                        The skew is plotted in the same subplot as the strike</span>
<span class="sd">                        angle at the moment</span>


<span class="sd">        -period          period array cooresponding to the impedance tensor</span>
<span class="sd">        -font_size       size of font for the axis ticklabels, note that the</span>
<span class="sd">                         axis labels will be font_size+2</span>

<span class="sd">        -axr             matplotlib.axes object for the xy,yx resistivity plot.</span>
<span class="sd">        -axp             matplotlib.axes object for the xy,yx phase plot</span>
<span class="sd">        -axt             matplotlib.axes object for the tipper plot</span>
<span class="sd">        -ax2r            matplotlib.axes object for the xx,yy resistivity plot</span>
<span class="sd">        -ax2p            matplotlib.axes object for the xx,yy phase plot</span>
<span class="sd">        -axs             matplotlib.axes object for the strike plot</span>
<span class="sd">        -axs2            matplotlib.axes object for the skew plot</span>

<span class="sd">        ..</span>

<span class="sd">             **Note:** that from these axes object you have control of the</span>
<span class="sd">             plot.  You can do this by changing any parameter in the</span>
<span class="sd">             axes object and then calling update_plot()</span>

<span class="sd">        -erxyr          class matplotlib.container.ErrorbarContainer for</span>
<span class="sd">                        xy apparent resistivity.</span>
<span class="sd">        -erxyp          class matplotlib.container.ErrorbarContainer for</span>
<span class="sd">                        xy.</span>
<span class="sd">        -eryxr          class matplotlib.container.ErrorbarContainer for</span>
<span class="sd">                        yx apparent resistivity.</span>
<span class="sd">        -eryxp          class matplotlib.container.ErrorbarContainer for</span>
<span class="sd">                        yx phase.</span>

<span class="sd">        ..</span>

<span class="sd">            **Note:** that from these line objects you can manipulate the</span>
<span class="sd">            error bar properties and then call update_plot()</span>

<span class="sd">        -xy_ls           line style for xy and xx components, *default* is None</span>
<span class="sd">        -yx_ls           line style for yx and yy components, *default* is None</span>
<span class="sd">        -det_ls          line style for determinant, *default* is None</span>

<span class="sd">        -xy_marker       marker for xy and xx, *default* is squares</span>
<span class="sd">        -yx_marker       marker for yx and yy, *default* is circles</span>
<span class="sd">        -det_marker      marker for determinant, *default* is diamonds</span>

<span class="sd">        -xy_color        marker color for xy and xx, *default* is blue</span>
<span class="sd">        -yx_color        marker color for yx and yy, *default* is red</span>
<span class="sd">        -det_color       marker color for determinant, *default* is green</span>

<span class="sd">        -xy_mfc          marker face color for xy and xx, *default* is None</span>
<span class="sd">        -yx_mfc          marker face color for yx and yy, *default* is None</span>
<span class="sd">        -det_mfc         marker face color for determinant, *default* is None</span>

<span class="sd">        -skew_marker     marker for skew angle, *default* is &#39;d&#39;</span>
<span class="sd">        -skew_color      color for skew angle, *default* is &#39;orange&#39;</span>

<span class="sd">        -strike_inv_marker  marker for strike angle determined by invariants</span>
<span class="sd">                            *default* is &#39;^&#39;</span>
<span class="sd">        -strike_inv_color   color for strike angle determined by invaraiants</span>
<span class="sd">                            *default* is (.2, .2, .7)</span>
<span class="sd">        -strike_pt_marker  marker for strike angle determined by pt,</span>
<span class="sd">                           *default* is&#39;v&#39;</span>
<span class="sd">        -strike_pt_color   color for strike angle determined by pt</span>
<span class="sd">                           *default* is (.7, .2, .2)</span>

<span class="sd">        -strike_tip_marker  marker for strike angle determined by tipper</span>
<span class="sd">                            *default* is &#39;&gt;&#39;</span>
<span class="sd">        -strike_tip_color   color for strike angle determined by tipper</span>
<span class="sd">                            *default* is (.2, .7, .2)</span>

<span class="sd">        -marker_size     size of marker in relative dimenstions, *default* is 2</span>
<span class="sd">        -marker_lw       line width of marker, *default* is 100./dpi</span>
<span class="sd">        ..</span>

<span class="sd">         *For more on line and marker styles see matplotlib.lines.Line2D*</span>

<span class="sd">        -arrow_lw          line width of the arrow, *default* is 0.75</span>
<span class="sd">        -arrow_head_width  head width of the arrow, *default* is 0 for no arrow</span>
<span class="sd">                           head.  Haven&#39;t found a good way to scale the arrow</span>
<span class="sd">                           heads in a log scale.</span>

<span class="sd">        -arrow_head_height  head width of the arrow, *default* is 0 for no arrow</span>
<span class="sd">                            head.  Haven&#39;t found a good way to scale the arrow</span>
<span class="sd">                            heads in a log scale.</span>

<span class="sd">        -arrow_color_real  color of the real arrows, *default* is black</span>
<span class="sd">        -arrow_color_imag  color of the imaginary arrows, *default* is blue</span>

<span class="sd">        -arrow_direction   0 for pointing towards a conductor and -1 for</span>
<span class="sd">                           pointing away from a conductor.</span>


<span class="sd">        -xlimits        limits on the x-limits (period), *default* is None</span>
<span class="sd">                        which will estimate the min and max from the data,</span>
<span class="sd">                        setting the min as the floor(min(period)) and the max</span>
<span class="sd">                        as ceil(max(period)).  Input in linear scale if you</span>
<span class="sd">                        want to change the period limits, ie. (.1,1000)</span>

<span class="sd">        -res_limits     limits on the resistivity, *default* is None, which</span>
<span class="sd">                        will estimate the min and max from the data, rounding</span>
<span class="sd">                        to the lowest and highest increments to the power of 10</span>
<span class="sd">                        Input in linear scale if you want to change them,</span>
<span class="sd">                        ie. (1,10000). Note this only sets the xy and yx</span>
<span class="sd">                        components, not the xx and yy.</span>

<span class="sd">        -phase_limits   limits on the phase, *default* is (0,90) but will</span>
<span class="sd">                        adapt to the data if there is phase above 90 or below</span>
<span class="sd">                        0.  Input in degrees.  Note this only changes the xy</span>
<span class="sd">                        and yx components.</span>

<span class="sd">        -tipper_limits  limits of the y-axis, *default* is (-1,1)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PlotMultipleResponses</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="n">fn_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fn_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">z_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;z_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tipper_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tipper_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mt_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mt_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># --&gt; get the inputs into a list of mt objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">get_mtlist</span><span class="p">(</span><span class="n">fn_list</span><span class="o">=</span><span class="n">fn_list</span><span class="p">,</span>
                                       <span class="n">z_object_list</span><span class="o">=</span><span class="n">z_object_list</span><span class="p">,</span>
                                       <span class="n">tipper_object_list</span><span class="o">=</span><span class="n">tipper_object_list</span><span class="p">,</span>
                                       <span class="n">mt_object_list</span><span class="o">=</span><span class="n">mt_object_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_num&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">)</span>

        <span class="c1"># set some of the properties as attributes much to Lars&#39; discontent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_style</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_style&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># if rotation angle is an int or float make an array the length of</span>
        <span class="c1"># mt_list for plotting purposes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rot_z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="c1"># if the rotation angle is an array for rotation of different</span>
        <span class="c1"># freq than repeat that rotation array to the len(mt_list)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_rot_z</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">)</span>

        <span class="c1"># set plot limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;xlimits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;res_limits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;phase_limits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tipper_limits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;strike_limits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;skew_limits&#39;</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pt_limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pt_limits&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># set font parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_size&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="c1"># set plot tipper or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_tipper&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

        <span class="c1"># plot strike angle or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_strike&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

        <span class="c1"># plot skew angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_skew&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

        <span class="c1"># plot phase tensor ellipses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_pt&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

        <span class="c1"># order of plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_order</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_order&#39;</span><span class="p">,</span>
                                     <span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span> <span class="s1">&#39;strike&#39;</span><span class="p">,</span> <span class="s1">&#39;skew&#39;</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">kk</span><span class="p">,</span> <span class="n">vv</span><span class="p">)</span> <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">vv</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;pt&#39;</span><span class="p">,</span>
                                                           <span class="s1">&#39;strike&#39;</span><span class="p">,</span> <span class="s1">&#39;skew&#39;</span><span class="p">],</span>
                                                          <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="p">,</span>
                                                           <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span><span class="p">])])</span>

        <span class="c1"># set arrow properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span> <span class="o">=</span> <span class="mf">0.03</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>

        <span class="c1"># ellipse_properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">=</span> <span class="mf">0.25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ellipse_spacing&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">=</span> <span class="mf">0.25</span>

        <span class="c1"># --&gt; set text box parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_location</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_location&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_xpad</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_xpad&#39;</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_ypad</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_ypad&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_size&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_weight</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_yn&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>

        <span class="c1"># plot on initializing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

    <span class="c1"># ---rotate data on setting rot_z</span>
    <span class="k">def</span> <span class="nf">_set_rot_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        need to rotate data when setting z</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># if rotation angle is an int or float make an array the length of</span>
        <span class="c1"># mt_list for plotting purposes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rot_z</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="c1"># if the rotation angle is an array for rotation of different</span>
        <span class="c1"># freq than repeat that rotation array to the len(mt_list)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rot_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
            <span class="n">mt</span><span class="o">.</span><span class="n">rot_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_rot_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span>

    <span class="n">rot_z</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_rot_z</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_rot_z</span><span class="p">,</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;rotation angle(s)&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># --&gt; on setting plot_ make sure to update the order and list</span>
    <span class="k">def</span> <span class="nf">_set_plot_tipper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_tipper</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If plotting tipper make arrow attributes</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span> <span class="o">=</span> <span class="n">plot_tipper</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span>

    <span class="k">def</span> <span class="nf">_get_plot_tipper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span>

    <span class="n">plot_tipper</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_tipper</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_tipper</span><span class="p">,</span>
                           <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot tipper&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_plot_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_pt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If plotting tipper make arrow attributes</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">=</span> <span class="n">plot_pt</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span>

    <span class="k">def</span> <span class="nf">_get_plot_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span>

    <span class="n">plot_pt</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_pt</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_pt</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot phase tensor ellipses&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_plot_strike</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_strike</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        change plot_dict when changing plot_strike</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span> <span class="o">=</span> <span class="n">plot_strike</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span>

    <span class="k">def</span> <span class="nf">_get_plot_strike</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span>

    <span class="n">plot_strike</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_strike</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_strike</span><span class="p">,</span>
                           <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot strike&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_plot_skew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_skew</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        change plot_dict when changing plot_strike</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">=</span> <span class="n">plot_skew</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span>

    <span class="k">def</span> <span class="nf">_get_plot_skew</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span>

    <span class="n">plot_skew</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_plot_skew</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_plot_skew</span><span class="p">,</span>
                         <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;string to plot skew&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># ---plot the resistivity and phase</span>
<div class="viewcode-block" id="PlotMultipleResponses.plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotnresponses.PlotMultipleResponses.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        plot the apparent resistivity and phase</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create a dictionary for the number of subplots needed</span>
        <span class="n">pdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="s1">&#39;phase&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="c1"># start the index at 2 because resistivity and phase is permanent</span>
        <span class="c1"># for now</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pdict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
                <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># get number of rows needed</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">index</span>

        <span class="c1"># set height ratios of the subplots</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1">#        if self.plot_style == &#39;1&#39;:</span>
        <span class="c1">#            self.plotlist = []</span>
        <span class="c1">#</span>
        <span class="c1">#            #--&gt; plot from edi&#39;s if given, don&#39;t need to rotate because</span>
        <span class="c1">#            #    data has already been rotated by the funcion _set_rot_z</span>
        <span class="c1">##            if self.fig_size is None:</span>
        <span class="c1">##                self.fig_size = [6, 6]</span>
        <span class="c1">#            for ii, mt in enumerate(self.mt_list, 1):</span>
        <span class="c1">#                p1 = plotresponse(mt_object=mt,</span>
        <span class="c1">#                                  fig_num=ii,</span>
        <span class="c1">#                                  fig_size=self.fig_size,</span>
        <span class="c1">#                                  plot_num=self.plot_num,</span>
        <span class="c1">#                                  fig_dpi=self.fig_dpi,</span>
        <span class="c1">#                                  plot_yn=&#39;n&#39;,</span>
        <span class="c1">#                                  plot_tipper=self._plot_tipper,</span>
        <span class="c1">#                                  plot_strike=self._plot_strike,</span>
        <span class="c1">#                                  plot_skew=self._plot_skew,</span>
        <span class="c1">#                                  plot_pt=self._plot_pt)</span>
        <span class="c1">#</span>
        <span class="c1">#                #make sure all the properties are set to match the users</span>
        <span class="c1">#                #line style between points</span>
        <span class="c1">#                p1.xy_ls = self.xy_ls</span>
        <span class="c1">#                p1.yx_ls = self.yx_ls</span>
        <span class="c1">#                p1.det_ls = self.det_ls</span>
        <span class="c1">#</span>
        <span class="c1">#                #outline color</span>
        <span class="c1">#                p1.xy_color = self.xy_color</span>
        <span class="c1">#                p1.yx_color = self.yx_color</span>
        <span class="c1">#                p1.det_color = self.det_color</span>
        <span class="c1">#</span>
        <span class="c1">#                #face color</span>
        <span class="c1">#                p1.xy_mfc = self.xy_mfc</span>
        <span class="c1">#                p1.yx_mfc = self.yx_mfc</span>
        <span class="c1">#                p1.det_mfc = self.det_mfc</span>
        <span class="c1">#</span>
        <span class="c1">#                #maker</span>
        <span class="c1">#                p1.xy_marker = self.xy_marker</span>
        <span class="c1">#                p1.yx_marker = self.yx_marker</span>
        <span class="c1">#                p1.det_marker = self.det_marker</span>
        <span class="c1">#</span>
        <span class="c1">#                #size</span>
        <span class="c1">#                p1.marker_size = 2</span>
        <span class="c1">#</span>
        <span class="c1">#                #set plot limits</span>
        <span class="c1">#                p1.xlimits = self.xlimits</span>
        <span class="c1">#                p1.res_limits = self.res_limits</span>
        <span class="c1">#                p1.phase_limits = self.phase_limits</span>
        <span class="c1">#</span>
        <span class="c1">#                #set font parameters</span>
        <span class="c1">#                p1.font_size = self.font_size</span>
        <span class="c1">#</span>
        <span class="c1">#                #set arrow properties</span>
        <span class="c1">#                p1.arrow_lw = self.arrow_lw</span>
        <span class="c1">#                p1.arrow_head_width = self.arrow_head_width</span>
        <span class="c1">#                p1.arrow_head_length = self.arrow_head_length</span>
        <span class="c1">#                p1.arrow_color_real = self.arrow_color_real</span>
        <span class="c1">#                p1.arrow_color_imag = self.arrow_color_imag</span>
        <span class="c1">#                p1.arrow_direction = self.arrow_direction</span>
        <span class="c1">#                p1.tipper_limits = self.tipper_limits</span>
        <span class="c1">#</span>
        <span class="c1">#                #skew properties</span>
        <span class="c1">#                p1.skew_color = self.skew_color</span>
        <span class="c1">#                p1.skew_marker = self.skew_marker</span>
        <span class="c1">#</span>
        <span class="c1">#                #strike properties</span>
        <span class="c1">#                p1.strike_inv_marker = self.strike_inv_marker</span>
        <span class="c1">#                p1.strike_inv_color = self.strike_inv_color</span>
        <span class="c1">#</span>
        <span class="c1">#                p1.strike_pt_marker = self.strike_pt_marker</span>
        <span class="c1">#                p1.strike_pt_color = self.strike_pt_color</span>
        <span class="c1">#</span>
        <span class="c1">#                p1.strike_tip_marker = self.strike_tip_marker</span>
        <span class="c1">#                p1.strike_tip_color = self.strike_tip_color</span>
        <span class="c1">#</span>
        <span class="c1">#                #--&gt; plot the apparent resistivity and phase</span>
        <span class="c1">#                self.plotlist.append(p1)</span>
        <span class="c1">#</span>
        <span class="c1">#                p1.plot()</span>
        <span class="c1">#</span>

        <span class="c1"># -----Plot All in one figure with each plot as a subfigure------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_style</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>

            <span class="n">stlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">stlabel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">st_maxlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">st_minlist</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">ns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">)</span>

            <span class="c1"># set some parameters of the figure and subplot spacing</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_skew</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">94</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">93</span>

            <span class="c1"># set the font properties for the axis labels</span>
            <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span>

            <span class="c1"># set figure size according to what the plot will be.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">ns</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">ns</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

            <span class="c1"># make a figure instance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>

            <span class="c1"># make subplots as columns for all stations that need to be plotted</span>
            <span class="n">gs0</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span>

            <span class="c1"># space out the subplots</span>
            <span class="n">gs0</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">025</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mi">025</span><span class="p">,</span> <span class="n">left</span><span class="o">=.</span><span class="mi">085</span><span class="p">)</span>

            <span class="n">labelcoords</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.145</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">axr</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">axt</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">axpt</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">axst</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">axsk</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>  <span class="c1"># type: int, MT</span>
                <span class="c1"># get the reistivity and phase object</span>
                <span class="n">rp</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Z</span>

                <span class="c1"># set x-axis limits from short period to long period</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span>
                                    <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))))</span>
                <span class="c1"># if self.phase_limits is None:</span>
                <span class="c1">#     pass</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                      <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="o">.</span><span class="n">min</span><span class="p">()])))),</span>
                                       <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
                                           <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                                         <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="o">.</span><span class="n">max</span><span class="p">()])))))</span>

                <span class="c1"># create a grid to place the figures into, set to have 2 rows</span>
                <span class="c1"># and 2 columns to put any of the 4 components.  Make the phase</span>
                <span class="c1"># plot slightly shorter than the apparent resistivity plot and</span>
                <span class="c1"># have the two close to eachother vertically.</span>
                <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpecFromSubplotSpec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                                      <span class="n">subplot_spec</span><span class="o">=</span><span class="n">gs0</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                      <span class="n">height_ratios</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span>
                                                      <span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                                                      <span class="n">wspace</span><span class="o">=.</span><span class="mi">0125</span><span class="p">)</span>

                <span class="c1"># --&gt; create the axes instances for xy, yx</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># apparent resistivity axis</span>
                    <span class="n">axr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">)</span>

                    <span class="c1"># phase axis that shares period axis with resistivity</span>
                    <span class="n">axp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">)</span><span class="c1"># --&gt; make figure for xy,yx components</span>
                    <span class="c1"># space out the subplots</span>
                    <span class="c1"># gs.update(hspace=.05, wspace=.02, left=.1)</span>

                <span class="c1"># --&gt; make figure for all 4 components</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># --&gt; create the axes instances</span>
                    <span class="c1"># apparent resistivity axis</span>
                    <span class="n">axr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">)</span>

                    <span class="c1"># phase axis that shares period axis with resistivity</span>
                    <span class="n">axp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">)</span>

                    <span class="c1"># space out the subplots</span>
                    <span class="c1"># gs.update(hspace=.05, wspace=.02, left=.07)</span>


                <span class="c1"># place y coordinate labels in the same location</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="c1"># --&gt; plot tipper</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">axt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">],</span> <span class="p">:],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axt</span><span class="p">)</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># --&gt; plot phase tensors</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># can&#39;t share axis because not on the same scale</span>
                    <span class="n">axpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axpt</span><span class="p">)</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># --&gt; plot strike</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">axst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axst</span><span class="p">)</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># --&gt; plot skew</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">axsk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axsk</span><span class="p">)</span>
                    <span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="c1"># ---------plot the apparent resistivity----------------------</span>
                <span class="c1"># --&gt; plot as error bars and just as points xy-blue, yx-red</span>
                <span class="c1"># res_xy</span>
                <span class="n">ebxyr</span> <span class="o">=</span> <span class="n">axr</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                     <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="p">,</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span>
                                     <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_mfc</span><span class="p">,</span>
                                     <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                     <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                     <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                     <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xy</span><span class="p">,</span>
                                     <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                     <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># res_yx</span>
                <span class="n">ebyxr</span> <span class="o">=</span> <span class="n">axr</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                     <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="p">,</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span>
                                     <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_mfc</span><span class="p">,</span>
                                     <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                     <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                     <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                     <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yx</span><span class="p">,</span>
                                     <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                     <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># --&gt; set axes properties</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
                <span class="n">axr</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                         <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;App. Res. ($\mathbf{\Omega \cdot m}$)&#39;</span><span class="p">,</span>
                                   <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">ebxyr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ebyxr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="p">(</span><span class="s1">&#39;$Z_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Z_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">),</span>
                               <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                               <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                               <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># -----Plot the phase----------------------------------------</span>
                <span class="c1"># phase_xy</span>
                <span class="n">ebxyp</span> <span class="o">=</span> <span class="n">axp</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                     <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">,</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span>
                                     <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_mfc</span><span class="p">,</span>
                                     <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                     <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                     <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                     <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xy</span><span class="p">,</span>
                                     <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                     <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># phase_yx:</span>
                <span class="n">ebyxp</span> <span class="o">=</span> <span class="n">axp</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                     <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span> <span class="o">+</span> <span class="mi">180</span><span class="p">,</span>
                                     <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span>
                                     <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_mfc</span><span class="p">,</span>
                                     <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                     <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                     <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                     <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yx</span><span class="p">,</span>
                                     <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                     <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                     <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># check the phase to see if any point are outside of [0:90]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">pymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)]))</span>
                    <span class="n">pymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">89.9</span><span class="p">,</span> <span class="nb">max</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">rp</span><span class="o">.</span><span class="n">phase_yx</span><span class="p">)]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">pymin</span><span class="p">,</span> <span class="n">pymax</span><span class="p">)</span>
                <span class="c1">#     self.phase_limits = (pymin, pymax)</span>
                <span class="c1"># else:</span>
                <span class="c1">#     self.phase_limits = (min(self.phase_limits[0], pymin),</span>
                <span class="c1">#                          max(self.phase_limits[1], pymax))</span>
                <span class="c1"># if self.phase_limits is None:</span>
                <span class="c1">#     if min(rp.phasexy) &lt; 0 or min(rp.phase_yx) &lt; 0:</span>
                <span class="c1">#         pymin = min([min(rp.phase_xy),</span>
                <span class="c1">#                      min(rp.phase_yx)])</span>
                <span class="c1">#         if pymin &gt; 0:</span>
                <span class="c1">#             pymin = 0</span>
                <span class="c1">#     else:</span>
                <span class="c1">#         pymin = 0</span>
                <span class="c1">#</span>
                <span class="c1">#     if max(rp.phasexy) &gt; 90 or max(rp.phase_yx) &gt; 90:</span>
                <span class="c1">#         pymax = min([max(rp.phase_xy),  # YG: should use max instead ??</span>
                <span class="c1">#                      max(rp.phase_yx)])</span>
                <span class="c1">#         if pymax &lt; 91:</span>
                <span class="c1">#             pymax = 89.9  # YG: why??</span>
                <span class="c1">#     else:</span>
                <span class="c1">#         pymax = 89.9</span>
                <span class="c1">#</span>
                <span class="c1">#     self.phase_limits = (pymin, pymax)</span>

                <span class="c1"># --&gt; set axes properties</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (deg)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_skew</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">and</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">plot_strike</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>

                <span class="n">axp</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">179.9</span><span class="p">,</span><span class="mf">179.9</span><span class="p">)</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="n">axp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                         <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                         <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                <span class="n">tklabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">tklabels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="n">axp</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                    <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># -----plot tipper--------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="n">tp</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span>

                    <span class="n">txr</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">mag_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                               <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
                    <span class="n">tyr</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">mag_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                               <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>

                    <span class="n">txi</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">mag_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">angle_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                               <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
                    <span class="n">tyi</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">mag_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">angle_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                               <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>

                    <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">txr</span><span class="p">)</span>

                    <span class="n">tiplist</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">tiplabel</span> <span class="o">=</span> <span class="p">[]</span>

                    <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
                        <span class="n">xlenr</span> <span class="o">=</span> <span class="n">txr</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span> <span class="o">*</span> <span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span>
                        <span class="n">xleni</span> <span class="o">=</span> <span class="n">txi</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span> <span class="o">*</span> <span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span>

                        <span class="c1"># --&gt; plot real arrows</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                      <span class="mi">0</span><span class="p">,</span>
                                      <span class="n">xlenr</span><span class="p">,</span>
                                      <span class="n">tyr</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                      <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                      <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">,</span>
                                      <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">,</span>
                                      <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                      <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                      <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">line1</span> <span class="o">=</span> <span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_real</span><span class="p">)</span>
                                <span class="n">tiplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">tiplabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;real&#39;</span><span class="p">)</span>

                        <span class="c1"># --&gt; plot imaginary arrows</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                      <span class="mi">0</span><span class="p">,</span>
                                      <span class="n">xleni</span><span class="p">,</span>
                                      <span class="n">tyi</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                      <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">,</span>
                                      <span class="n">edgecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">,</span>
                                      <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                      <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                      <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                      <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">line2</span> <span class="o">=</span> <span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_color_imag</span><span class="p">)</span>
                                <span class="n">tiplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                                <span class="n">tiplabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;imag&#39;</span><span class="p">)</span>

                    <span class="c1"># make a line at 0 for reference</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">nt</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">tiplist</span><span class="p">,</span> <span class="n">tiplabel</span><span class="p">,</span>
                                   <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span>
                                   <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                   <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                   <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                   <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                   <span class="n">borderpad</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>
                                   <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                        <span class="n">axt</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tipper&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axt</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="c1"># set axis properties</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>

                    <span class="n">axt</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                        <span class="k">if</span> <span class="n">tmax</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">tmax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">899</span>

                        <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
                        <span class="k">if</span> <span class="n">tmin</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">tmin</span> <span class="o">=</span> <span class="o">-.</span><span class="mi">899</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmin</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>

                    <span class="n">axt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span><span class="p">)</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                             <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                    <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="n">axt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span><span class="p">])</span>
                            <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                    <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axt</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="c1"># need to reset the xlimits caouse they get reset when calling</span>
                    <span class="c1"># set_ticks for some reason</span>
                    <span class="n">axt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                <span class="c1"># ------plot strike angles----------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># strike from invariants</span>
                        <span class="n">zinv</span> <span class="o">=</span> <span class="n">Zinvariants</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
                        <span class="n">s1</span> <span class="o">=</span> <span class="n">zinv</span><span class="o">.</span><span class="n">strike</span>

                        <span class="c1"># fold angles so go from -90 to 90</span>
                        <span class="n">s1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="o">-</span><span class="mi">180</span>
                        <span class="n">s1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s1</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

                        <span class="c1"># plot strike with error bars</span>
                        <span class="n">ps1</span> <span class="o">=</span> <span class="n">axst</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="n">s1</span><span class="p">,</span>
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_inv_marker</span><span class="p">,</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_inv_color</span><span class="p">,</span>
                                            <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_inv_color</span><span class="p">,</span>
                                            <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                            <span class="n">yerr</span><span class="o">=</span><span class="n">zinv</span><span class="o">.</span><span class="n">strike_err</span><span class="p">,</span>
                                            <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_inv_color</span><span class="p">,</span>
                                            <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                        <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Z_inv&#39;</span><span class="p">)</span>
                        <span class="n">st_maxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                        <span class="n">st_minlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># strike from phase tensor</span>
                        <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>  <span class="c1"># type: PhaseTensor</span>
                        <span class="n">s2</span><span class="p">,</span> <span class="n">s2_err</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth_err</span>

                        <span class="c1"># fold angles to go from -90 to 90</span>
                        <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                        <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

                        <span class="c1"># plot strike with error bars</span>
                        <span class="n">ps2</span> <span class="o">=</span> <span class="n">axst</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="n">s2</span><span class="p">,</span>
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_marker</span><span class="p">,</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_color</span><span class="p">,</span>
                                            <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_color</span><span class="p">,</span>
                                            <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                            <span class="n">yerr</span><span class="o">=</span><span class="n">s2_err</span><span class="p">,</span>
                                            <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_pt_color</span><span class="p">,</span>
                                            <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                        <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;PT&#39;</span><span class="p">)</span>
                        <span class="n">st_maxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                        <span class="n">st_minlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># strike from tipper</span>
                        <span class="n">tp</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span>
                        <span class="n">s3</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">+</span> <span class="mi">90</span>

                        <span class="c1"># fold to go from -90 to 90</span>
                        <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                        <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

                        <span class="c1"># plot strike with error bars</span>
                        <span class="n">ps3</span> <span class="o">=</span> <span class="n">axst</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="n">s3</span><span class="p">,</span>
                                            <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_marker</span><span class="p">,</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_color</span><span class="p">,</span>
                                            <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_color</span><span class="p">,</span>
                                            <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                            <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                            <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s3</span><span class="p">),</span>
                                            <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_tip_color</span><span class="p">,</span>
                                            <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                        <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Tip&#39;</span><span class="p">)</span>
                        <span class="n">st_maxlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
                        <span class="n">st_minlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s3</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

                    <span class="c1"># --&gt; set axes properties</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">stmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">st_minlist</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">stmin</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">:</span>
                            <span class="n">stmin</span> <span class="o">-=</span> <span class="mi">3</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">stmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">89.99</span>

                        <span class="n">stmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">st_maxlist</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">stmin</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">:</span>
                            <span class="n">stmin</span> <span class="o">+=</span> <span class="mi">3</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">stmin</span> <span class="o">=</span> <span class="mf">89.99</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="nb">max</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">stmin</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">stmax</span><span class="p">)]),</span>
                                              <span class="nb">max</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">stmin</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">stmax</span><span class="p">)]))</span>

                    <span class="n">axst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">axr</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axst</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Strike&#39;</span><span class="p">,</span>
                                        <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axst</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span>
                                    <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span><span class="p">)</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axst</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                              <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">axst</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">stlist</span><span class="p">,</span>
                                        <span class="n">stlabel</span><span class="p">,</span>
                                        <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                        <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                        <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                        <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                        <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                        <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">,</span>
                                        <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">})</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="k">pass</span>

                    <span class="c1"># set th xaxis tick labels to invisible</span>
                    <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axst</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># ------plot skew angle---------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="c1"># strike from phase tensor</span>
                    <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>
                    <span class="n">sk</span><span class="p">,</span> <span class="n">sk_err</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="n">pt</span><span class="o">.</span><span class="n">beta_err</span>

                    <span class="n">ps4</span> <span class="o">=</span> <span class="n">axsk</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                        <span class="n">sk</span><span class="p">,</span>
                                        <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_marker</span><span class="p">,</span>
                                        <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                        <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_color</span><span class="p">,</span>
                                        <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_color</span><span class="p">,</span>
                                        <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                        <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                        <span class="n">yerr</span><span class="o">=</span><span class="n">sk_err</span><span class="p">,</span>
                                        <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_color</span><span class="p">,</span>
                                        <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                        <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>
                    <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps4</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">stlabel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Skew&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

                    <span class="n">axsk</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span><span class="p">)</span>
                    <span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                    <span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">axsk</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Skew&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axsk</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">axsk</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                    <span class="n">axsk</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>

                    <span class="c1"># set th xaxis tick labels to invisible</span>
                    <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axsk</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># ----plot phase tensor ellipse---------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="c1"># get phase tensor instance</span>
                    <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>

                    <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_cmap</span>
                    <span class="n">ckmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">ckmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ckstep</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                        <span class="n">ckstep</span> <span class="o">=</span> <span class="mi">3</span>

                    <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                        <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span><span class="p">,</span> <span class="n">ckmax</span> <span class="o">+</span> <span class="n">ckstep</span><span class="p">,</span> <span class="n">ckstep</span><span class="p">)</span>
                        <span class="n">nseg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ckstep</span><span class="p">))</span>

                    <span class="c1"># get the properties to color the ellipses by</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phiminang&#39;</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phimin&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phidet&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">det</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew&#39;</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew_seg&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">beta</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;ellipticity&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">ellipticity</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">+</span> <span class="s1">&#39; is not supported&#39;</span><span class="p">)</span>

                    <span class="c1"># -------------plot ellipses-----------------------------------</span>
                    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">ff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">):</span>
                        <span class="c1"># make sure the ellipses will be visable</span>
                        <span class="n">eheight</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">/</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">*</span> \
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>
                        <span class="n">ewidth</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">/</span> <span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">*</span> \
                                 <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>

                        <span class="c1"># create an ellipse scaled by phimin and phimax and</span>
                        <span class="c1"># oriented along the azimuth which is calculated as</span>
                        <span class="c1"># clockwise but needs to be plotted counter-clockwise</span>
                        <span class="c1"># hence the negative sign.</span>
                        <span class="n">ellipd</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="o">*</span> \
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">,</span>
                                                  <span class="mi">0</span><span class="p">),</span>
                                                 <span class="n">width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span>
                                                 <span class="n">height</span><span class="o">=</span><span class="n">eheight</span><span class="p">,</span>
                                                 <span class="n">angle</span><span class="o">=</span><span class="mi">90</span> <span class="o">-</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>

                        <span class="n">axpt</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipd</span><span class="p">)</span>

                        <span class="c1"># get ellipse color</span>
                        <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;seg&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span>
                                <span class="n">colorarray</span><span class="p">[</span><span class="n">kk</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                <span class="n">cmap</span><span class="p">,</span>
                                <span class="n">ckmin</span><span class="p">,</span>
                                <span class="n">ckmax</span><span class="p">,</span>
                                <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span>
                                <span class="n">colorarray</span><span class="p">[</span><span class="n">kk</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                <span class="n">cmap</span><span class="p">,</span>
                                <span class="n">ckmin</span><span class="p">,</span>
                                <span class="n">ckmax</span><span class="p">))</span>

                    <span class="c1"># ----set axes properties-----------------------------------------------</span>
                    <span class="c1"># --&gt; set tick labels and limits</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                                  <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>

                    <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="n">axpt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span><span class="p">])</span>
                            <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                            <span class="k">pass</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                         <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="n">axpt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span><span class="p">,</span>
                                  <span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span><span class="p">)</span>

                    <span class="n">axpt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                              <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                              <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="c1"># add colorbar for PT only for first plot</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axpos</span> <span class="o">=</span> <span class="n">axpt</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
                        <span class="n">cb_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">0575</span><span class="p">,</span>
                                       <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">02</span><span class="p">,</span>
                                       <span class="o">.</span><span class="mi">01</span><span class="p">,</span>
                                       <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">75</span><span class="p">)</span>
                        <span class="n">cbax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">cb_position</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                            <span class="c1"># make a color list</span>
                            <span class="n">clist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                                     <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
                                                         <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">),</span>
                                                         <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">))]</span> <span class="o">+</span> \
                                    <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
                                     <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span>
                                                         <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">),</span>
                                                         <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">))]</span>

                            <span class="c1"># make segmented colormap</span>
                            <span class="n">mt_seg_bl2wh2rd</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">clist</span><span class="p">)</span>

                            <span class="c1"># make bounds so that the middle is white</span>
                            <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span> <span class="o">-</span> <span class="n">ckstep</span><span class="p">,</span> <span class="n">ckmax</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ckstep</span><span class="p">,</span>
                                               <span class="n">ckstep</span><span class="p">)</span>

                            <span class="c1"># normalize the colors</span>
                            <span class="n">norms</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span>
                                                        <span class="n">mt_seg_bl2wh2rd</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

                            <span class="c1"># make the colorbar</span>
                            <span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbax</span><span class="p">,</span>
                                                    <span class="n">cmap</span><span class="o">=</span><span class="n">mt_seg_bl2wh2rd</span><span class="p">,</span>
                                                    <span class="n">norm</span><span class="o">=</span><span class="n">norms</span><span class="p">,</span>
                                                    <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                                                    <span class="n">ticks</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cbax</span><span class="p">,</span>
                                                    <span class="n">cmap</span><span class="o">=</span><span class="n">mtcl</span><span class="o">.</span><span class="n">cmapdict</span><span class="p">[</span><span class="n">cmap</span><span class="p">],</span>
                                                    <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">ckmin</span><span class="p">,</span>
                                                                          <span class="n">vmax</span><span class="o">=</span><span class="n">ckmax</span><span class="p">),</span>
                                                    <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="n">ckmin</span><span class="p">,</span> <span class="p">(</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ckmax</span><span class="p">])</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmin</span><span class="p">),</span>
                                             <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                                             <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmax</span><span class="p">)])</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
                        <span class="n">cbpt</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">ckdict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">],</span>
                                       <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                <span class="c1"># ==  == Plot the Z_xx, Z_yy components if desired ==</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># ---------plot the apparent resistivity----------------</span>
                    <span class="n">axr2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axr</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

                    <span class="c1"># res_xx</span>
                    <span class="n">ebxxr</span> <span class="o">=</span> <span class="n">axr2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xx</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xx</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># res_yy</span>
                    <span class="n">ebyyr</span> <span class="o">=</span> <span class="n">axr2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yy</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yy</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># --&gt; set axes properties</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
                    <span class="n">axr2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                              <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                              <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axr2</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">ebxxr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ebyyr</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                    <span class="p">(</span><span class="s1">&#39;$Z_</span><span class="si">{xx}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$Z_</span><span class="si">{yy}</span><span class="s1">$&#39;</span><span class="p">),</span>
                                    <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                    <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                    <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                    <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                    <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>

                    <span class="c1"># -----Plot the phase-----------------------------------</span>
                    <span class="n">axp2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">axr</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">axp</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

                    <span class="c1"># phase_xx</span>
                    <span class="n">ebxxp</span> <span class="o">=</span> <span class="n">axp2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xx</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xx</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># phase_yy</span>
                    <span class="n">ebyyp</span> <span class="o">=</span> <span class="n">axp2</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yy</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yy</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># --&gt; set axes properties</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp2</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">179.9</span><span class="p">,</span><span class="mf">179.9</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                    <span class="c1"># axp2.set_xticklabels(tklabels,</span>
                    <span class="c1">#                      fontdict={&#39;size&#39;: self.font_size})</span>
                    <span class="n">axp2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                              <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                              <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># == =Plot the Determinant if desired ==  ==  ==  ==</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

                    <span class="c1"># res_det</span>
                    <span class="n">ebdetr</span> <span class="o">=</span> <span class="n">axr</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">rp</span><span class="o">.</span><span class="n">res_det</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">res_det_err</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># phase_det</span>
                    <span class="n">ebdetp</span> <span class="o">=</span> <span class="n">axp</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                          <span class="n">rp</span><span class="o">.</span><span class="n">phase_det</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_marker</span><span class="p">,</span>
                                          <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">mfc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_mfc</span><span class="p">,</span>
                                          <span class="n">mec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>
                                          <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                          <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span>
                                          <span class="n">yerr</span><span class="o">=</span><span class="n">rp</span><span class="o">.</span><span class="n">phase_det_err</span><span class="p">,</span>
                                          <span class="n">ecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_color</span><span class="p">,</span>
                                          <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                          <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># --&gt; set axes properties</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axr</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;App. Res. ($\mathbf{\Omega \cdot m}$)&#39;</span><span class="p">,</span>
                                       <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axr</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="n">axr</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">)</span>
                    <span class="n">axr</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                             <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                             <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                    <span class="c1"># --&gt; set axes properties</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">axp</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (deg)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axp</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="n">axp</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                    <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tt</span><span class="p">]</span>
                                <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                    <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="n">tklabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">tklabels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                    <span class="n">axp</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
                    <span class="n">axp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                             <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                             <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                             <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="c1"># make title and show</span>

                <span class="n">axr</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                              <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1"># ===Plot all responses into one plot to compare changes ==</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_style</span> <span class="o">==</span> <span class="s1">&#39;compare&#39;</span><span class="p">:</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">)</span>

            <span class="c1"># make color lists for the plots going light to dark</span>
            <span class="n">cxy</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>
            <span class="n">cyx</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>
            <span class="n">cdet</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>
            <span class="n">ctipr</span> <span class="o">=</span> <span class="p">[(</span><span class="o">.</span><span class="mi">75</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">/</span> <span class="n">ns</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>
            <span class="n">ctipi</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>
            <span class="n">cst</span> <span class="o">=</span> <span class="p">[(</span><span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">/</span> <span class="n">ns</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">cc</span> <span class="o">/</span> <span class="n">ns</span><span class="p">)</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">)]</span>

            <span class="c1"># make marker lists for the different components</span>
            <span class="n">mxy</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
            <span class="n">myx</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>

            <span class="n">legendlistxy</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">legendlistyx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">stationlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">tiplist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">stlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sklist</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># set some parameters of the figure and subplot spacing</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">1</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">97</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">08</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>

            <span class="c1"># set the font properties for the axis labels</span>
            <span class="n">fontdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span>

            <span class="c1"># set figure size according to what the plot will be.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
                    <span class="k">pass</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
                    <span class="n">nrows</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># make a figure instance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span>
                                  <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>

            <span class="c1"># make a grid as usual, but put xy and yx in different plots</span>
            <span class="c1"># otherwise the plot is too busy to see what&#39;s going on.</span>
            <span class="n">hr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">hr</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">)</span>

            <span class="c1"># --&gt; make figure for xy,yx components</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># set label coordinates</span>
                <span class="n">labelcoords</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="c1"># space out the subplots</span>
                <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mi">02</span><span class="p">,</span> <span class="n">left</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># --&gt; make figure for all 4 components</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># set label coordinates</span>
                <span class="n">labelcoords</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="c1"># space out the subplots</span>
                <span class="n">gs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">hspace</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=.</span><span class="mi">02</span><span class="p">,</span> <span class="n">left</span><span class="o">=.</span><span class="mi">07</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pdict</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;res&#39;</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;phase&#39;</span><span class="p">:</span>
                        <span class="n">pdict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># --&gt; create the axes instances</span>
            <span class="c1"># apparent resistivity axis</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">,</span>
                                              <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>

            <span class="c1"># phase axis that shares period axis with resistivity</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">,</span>
                                              <span class="n">sharey</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="p">)</span>

            <span class="c1"># place y coordinate labels in the same location</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># --&gt; plot tipper</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">],</span> <span class="p">:])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                                                <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># --&gt; plot phase tensors</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># can&#39;t share axis because not on the same scale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                 <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                                                 <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># --&gt; plot strike</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                 <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                                                 <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># --&gt; plot skew</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">],</span> <span class="p">:],</span>
                                                 <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="n">labelcoords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">5</span><span class="p">,</span>
                                                 <span class="n">labelcoords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
                <span class="c1"># get the reistivity and phase object</span>

                <span class="c1"># set x-axis limits from short period to long period</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">min</span><span class="p">()))),</span>
                                    <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">max</span><span class="p">()))))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="nb">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">min</span><span class="p">()))]),</span>
                                    <span class="mi">10</span> <span class="o">**</span> <span class="nb">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">max</span><span class="p">()))]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">89.9</span><span class="p">)</span>

                <span class="n">stationlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">)</span>

                <span class="c1"># ==  ==  ==  == =Plot Z_xy and Z_yx ==</span>
                <span class="c1"># if self.plot_num == 1 or self.plot_num == 2:</span>
                <span class="c1"># ---------plot the apparent resistivity--------------------</span>
                <span class="c1"># --&gt; plot as error bars and just as points xy-blue, yx-red</span>
                <span class="c1"># res_xy</span>
                <span class="n">ebxyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xy</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                            <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                            <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xy</span><span class="p">,</span>
                                            <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># res_yx</span>
                <span class="n">ebyxr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                            <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yx</span><span class="p">,</span>
                                            <span class="n">color</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">marker</span><span class="o">=</span><span class="n">myx</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">myx</span><span class="p">)],</span>
                                            <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                            <span class="n">mec</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                            <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                            <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yx</span><span class="p">,</span>
                                            <span class="n">ecolor</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                            <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                            <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># -----Plot the phase---------------------------------------</span>
                <span class="c1"># phase_xy</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                    <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xy</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                    <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                    <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                    <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                    <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                    <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xy</span><span class="p">,</span>
                                    <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                    <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># phase_yx: Note add 180 to place it in same quadrant as</span>
                <span class="c1"># phase_xy</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                    <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yx</span> <span class="o">+</span> <span class="mi">180</span><span class="p">,</span>
                                    <span class="n">color</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">marker</span><span class="o">=</span><span class="n">myx</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">myx</span><span class="p">)],</span>
                                    <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                    <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                    <span class="n">mec</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                    <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                    <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yx</span><span class="p">,</span>
                                    <span class="n">ecolor</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                    <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                    <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="n">legendlistxy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ebxyr</span><span class="p">)</span>
                <span class="n">legendlistyx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ebyxr</span><span class="p">)</span>

                <span class="c1"># ==== Plot the Z_xx, Z_yy components if desired ==</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># ---------plot the apparent resistivity----------------</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axr2xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                                       <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axr2xx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">095</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axr2yy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                                       <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>

                    <span class="c1"># res_xx</span>
                    <span class="n">ebxxr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axr2xx</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_xx</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_xx</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># res_yy</span>
                    <span class="n">ebyyr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axr2yy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_yy</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">myx</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">myx</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_err_yy</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># -----Plot the phase-----------------------------------</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axp2xx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                                       <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axp2xx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-.</span><span class="mi">095</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axp2yy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                                       <span class="n">sharex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="p">)</span>

                    <span class="c1"># phase_xx</span>
                    <span class="n">ebxxp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axp2xx</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_xx</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xy_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_xx</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># phase_yy</span>
                    <span class="n">ebyyp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axp2yy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_yy</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">myx</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">yx_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_err_yy</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                <span class="c1"># ===Plot the Determinant if desired ==</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># res_det</span>
                    <span class="n">ebdetr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_det</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cdet</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">res_det_err</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cdet</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="c1"># phase_det</span>
                    <span class="n">ebdetp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_det</span><span class="p">,</span>
                                                 <span class="n">color</span><span class="o">=</span><span class="n">cyx</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cdet</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">det_ls</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">phase_det_err</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cdet</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                    <span class="n">legendlistxy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ebdetr</span><span class="p">)</span>

                <span class="c1"># -----plot tipper----------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="n">txr</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                                      <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
                    <span class="n">tyr</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                                      <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>

                    <span class="n">txi</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                                      <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>
                    <span class="n">tyi</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">mag_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_imag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">+</span> \
                                                      <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow_direction</span><span class="p">)</span>

                    <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">txr</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nt</span><span class="p">):</span>
                        <span class="n">xlenr</span> <span class="o">=</span> <span class="n">txr</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">])</span>
                        <span class="n">xleni</span> <span class="o">=</span> <span class="n">txi</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">])</span>

                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                            <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">min</span><span class="p">()])</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmax</span><span class="p">):</span>
                                <span class="n">tmax</span> <span class="o">=</span> <span class="mf">1.0</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmin</span><span class="p">):</span>
                                <span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmin</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmax</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">tmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span>
                            <span class="n">tmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">tyr</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">tyi</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="o">.</span><span class="mi">1</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmax</span><span class="p">):</span>
                                <span class="n">tmax</span> <span class="o">=</span> <span class="mf">1.0</span>
                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">tmin</span><span class="p">):</span>
                                <span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">)</span>

                        <span class="c1"># --&gt; plot real arrows</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                           <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">xlenr</span><span class="p">,</span>
                                           <span class="n">tyr</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                           <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                           <span class="n">facecolor</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                           <span class="n">edgecolor</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                           <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                           <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                           <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                        <span class="c1"># --&gt; plot imaginary arrows</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">[</span><span class="n">aa</span><span class="p">]),</span>
                                           <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">xleni</span><span class="p">,</span>
                                           <span class="n">tyi</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                                           <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_lw</span><span class="p">,</span>
                                           <span class="n">head_width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_width</span><span class="p">,</span>
                                           <span class="n">head_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arrow_head_length</span><span class="p">,</span>
                                           <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                    <span class="n">lt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
                    <span class="n">tiplist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># ------plot strike angles----------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

                    <span class="c1">#                    if self._plot_strike.find(&#39;i&#39;) &gt; 0:</span>
                    <span class="c1">#                        #strike from invariants</span>
                    <span class="c1">#                        zinv = mt.Z.invariants</span>
                    <span class="c1">#                        s1 = zinv.strike</span>
                    <span class="c1">#</span>
                    <span class="c1">#                        #fold angles so go from -90 to 90</span>
                    <span class="c1">#                        s1[np.where(s1&gt;90)] -= -180</span>
                    <span class="c1">#                        s1[np.where(s1&lt;-90)] += 180</span>
                    <span class="c1">#</span>
                    <span class="c1">#                        #plot strike with error bars</span>
                    <span class="c1">#                        ps1 = self.axst.errorbar(mt.period,</span>
                    <span class="c1">#                                                s1,</span>
                    <span class="c1">#                                                marker=mxy[ii % len(mxy)],</span>
                    <span class="c1">#                                                ms=self.marker_size,</span>
                    <span class="c1">#                                                mfc=cst[ii],</span>
                    <span class="c1">#                                                mec=cst[ii],</span>
                    <span class="c1">#                                                mew=self.marker_lw,</span>
                    <span class="c1">#                                                ls=&#39;none&#39;,</span>
                    <span class="c1">#                                                yerr=zinv.strike_err,</span>
                    <span class="c1">#                                                ecolor=cst[ii],</span>
                    <span class="c1">#                                                capsize=self.marker_size,</span>
                    <span class="c1">#                                                elinewidth=self.marker_lw)</span>
                    <span class="c1">#</span>
                    <span class="c1">#                        stlist.append(ps1[0])</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># strike from phase tensor</span>
                        <span class="n">s2</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span>
                        <span class="n">s2_err</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">azimuth_err</span>

                        <span class="c1"># fold angles to go from -90 to 90</span>
                        <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                        <span class="n">s2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s2</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

                        <span class="c1"># plot strike with error bars</span>
                        <span class="n">ps2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">s2</span><span class="p">,</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">myx</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">myx</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">s2_err</span><span class="p">,</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                        <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># strike from tipper</span>
                        <span class="n">s3</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span><span class="o">.</span><span class="n">angle_real</span> <span class="o">+</span> <span class="mi">90</span>

                        <span class="c1"># fold to go from -90 to 90</span>
                        <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                        <span class="n">s3</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">s3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

                        <span class="c1"># plot strike with error bars</span>
                        <span class="n">ps3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                                 <span class="n">s3</span><span class="p">,</span>
                                                 <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                                 <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">mfc</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mec</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                                 <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                                 <span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">s3</span><span class="p">),</span>
                                                 <span class="n">ecolor</span><span class="o">=</span><span class="n">ctipr</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                                 <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                                 <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>

                        <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps3</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># ------plot skew angle---------------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="c1"># strike from phase tensor</span>
                    <span class="n">sk</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>
                    <span class="n">sk_err</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta_err</span>

                    <span class="n">ps4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span>
                                             <span class="n">sk</span><span class="p">,</span>
                                             <span class="n">marker</span><span class="o">=</span><span class="n">mxy</span><span class="p">[</span><span class="n">ii</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">mxy</span><span class="p">)],</span>
                                             <span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                             <span class="n">mfc</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                             <span class="n">mec</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                             <span class="n">mew</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">,</span>
                                             <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                             <span class="n">yerr</span><span class="o">=</span><span class="n">sk_err</span><span class="p">,</span>
                                             <span class="n">ecolor</span><span class="o">=</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                                             <span class="n">capsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_size</span><span class="p">,</span>
                                             <span class="n">elinewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">marker_lw</span><span class="p">)</span>
                    <span class="n">stlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ps4</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># ----plot phase tensor ellipse---------------------------------------</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="c1"># get phase tensor instance</span>
                    <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>

                    <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_cmap</span>
                    <span class="n">ckmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">ckmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ckstep</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_range</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                        <span class="n">ckstep</span> <span class="o">=</span> <span class="mi">3</span>

                    <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                        <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span><span class="p">,</span> <span class="n">ckmax</span> <span class="o">+</span> <span class="n">ckstep</span><span class="p">,</span> <span class="n">ckstep</span><span class="p">)</span>
                        <span class="n">nseg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">((</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ckstep</span><span class="p">))</span>

                    <span class="c1"># get the properties to color the ellipses by</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phiminang&#39;</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phimin&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;phidet&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">det</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew&#39;</span> <span class="ow">or</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;skew_seg&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">beta</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">==</span> <span class="s1">&#39;ellipticity&#39;</span><span class="p">:</span>
                        <span class="n">colorarray</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">ellipticity</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span> <span class="o">+</span> <span class="s1">&#39; is not supported&#39;</span><span class="p">)</span>

                    <span class="c1"># -------------plot ellipses-----------------------------------</span>
                    <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">ff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">):</span>
                        <span class="c1"># make sure the ellipses will be visable</span>
                        <span class="n">eheight</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimin</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">/</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">*</span> \
                                  <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>
                        <span class="n">ewidth</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">/</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span><span class="o">.</span><span class="n">phimax</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span> <span class="o">*</span> \
                                 <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span>

                        <span class="c1"># create an ellipse scaled by phimin and phimax and oriented</span>
                        <span class="c1"># along the azimuth which is calculated as clockwise but needs</span>
                        <span class="c1"># to be plotted counter-clockwise hence the negative sign.</span>
                        <span class="n">ellipd</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ff</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">,</span>
                                                  <span class="n">ii</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">),</span>
                                                 <span class="n">width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span>
                                                 <span class="n">height</span><span class="o">=</span><span class="n">eheight</span><span class="p">,</span>
                                                 <span class="n">angle</span><span class="o">=</span><span class="mi">90</span> <span class="o">-</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="n">kk</span><span class="p">])</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">ellipd</span><span class="p">)</span>

                        <span class="c1"># get ellipse color</span>
                        <span class="k">if</span> <span class="n">cmap</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;seg&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span><span class="n">colorarray</span><span class="p">[</span><span class="n">kk</span><span class="p">],</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                                                     <span class="n">cmap</span><span class="p">,</span>
                                                                     <span class="n">ckmin</span><span class="p">,</span>
                                                                     <span class="n">ckmax</span><span class="p">,</span>
                                                                     <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">ellipd</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">mtcl</span><span class="o">.</span><span class="n">get_plot_color</span><span class="p">(</span><span class="n">colorarray</span><span class="p">[</span><span class="n">kk</span><span class="p">],</span>
                                                                     <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">,</span>
                                                                     <span class="n">cmap</span><span class="p">,</span>
                                                                     <span class="n">ckmin</span><span class="p">,</span>
                                                                     <span class="n">ckmax</span><span class="p">))</span>
                        <span class="n">ellipd</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">cxy</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>

            <span class="c1"># -------set axis properties---------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                            <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

            <span class="c1"># make a text label in upper left hand corner</span>
            <span class="c1"># label the plot with a text box</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">txloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_xpad</span>
                <span class="n">tyloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_ypad</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">txloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">tyloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">txloc</span><span class="p">,</span>
                                        <span class="n">tyloc</span><span class="p">,</span>
                                        <span class="s1">&#39;$Z_</span><span class="si">{xy}</span><span class="s1">$&#39;</span><span class="p">,</span>
                                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_weight</span><span class="p">},</span>
                                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;App. Resistivity($\Omega \cdot$m)&#39;</span><span class="p">,</span>
                                  <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                            <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">txloc</span><span class="p">,</span>
                                        <span class="n">tyloc</span><span class="p">,</span>
                                        <span class="s1">&#39;$Z_</span><span class="si">{yx}</span><span class="s1">$&#39;</span><span class="p">,</span>
                                        <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">,</span>
                                                  <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_weight</span><span class="p">},</span>
                                        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># check the phase to see if any point are outside of [0:90]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">89.99</span><span class="p">)</span>

            <span class="c1"># --&gt; set axes properties</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase(deg)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                            <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_limits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                            <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                            <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                            <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="c1"># make legend</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legendlistxy</span><span class="p">,</span>
                                  <span class="n">stationlist</span><span class="p">,</span>
                                  <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">markerscale</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span>
                                  <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                  <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                  <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">borderpad</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legendlistyx</span><span class="p">,</span>
                                  <span class="n">stationlist</span><span class="p">,</span>
                                  <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">markerscale</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span>
                                  <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                  <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                  <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">borderpad</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">llist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="n">legendlistxy</span><span class="p">]</span>
                <span class="n">slist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ss</span> <span class="o">+</span> <span class="s1">&#39;_det&#39;</span> <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">stationlist</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">llist</span><span class="p">,</span>
                                  <span class="n">slist</span><span class="p">,</span>
                                  <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">markerscale</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span>
                                  <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                  <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                  <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">borderpad</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">llist</span><span class="p">,</span>
                                  <span class="n">slist</span><span class="p">,</span>
                                  <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">markerscale</span><span class="o">=.</span><span class="mi">75</span><span class="p">,</span>
                                  <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                  <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                  <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">borderpad</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># --&gt; set axes properties for resxx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                                <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># --&gt; set axes properties for resyy</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposy</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_limits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                                <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axryx</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># --&gt; set axes properties Phasexx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">179.9</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                                <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="c1"># --&gt; set axes properties Phaseyy</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">179.9</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">179.9</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                                <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                                <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_tipper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>
                <span class="c1"># --&gt; set axis properties Tipper</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axpxy</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axpyx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tipper&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                  <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span><span class="p">])</span>
                        <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                         <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tipper_limits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                              <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                              <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                              <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">tiplist</span><span class="p">,</span>
                                <span class="n">stationlist</span><span class="p">,</span>
                                <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">markerscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">borderaxespad</span><span class="o">=.</span><span class="mi">01</span><span class="p">,</span>
                                <span class="n">labelspacing</span><span class="o">=.</span><span class="mi">07</span><span class="p">,</span>
                                <span class="n">handletextpad</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">borderpad</span><span class="o">=.</span><span class="mi">02</span><span class="p">)</span>

                <span class="c1"># need to reset the xlimits caouse they get reset when calling</span>
                <span class="c1"># set_ticks for some reason</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                  <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="c1"># --&gt; set axes properties for strike and skew</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_strike</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">89.99</span><span class="p">,</span> <span class="mf">89.99</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axrxy</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=.</span><span class="mi">5</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Strike(deg)&#39;</span><span class="p">,</span>
                                     <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span>
                                     <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strike_limits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                               <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                               <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                               <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>
                <span class="c1"># self.axst.legend(stlist,</span>
                <span class="c1">#                stationlist,</span>
                <span class="c1">#                loc=3,</span>
                <span class="c1">#                ncol=2,</span>
                <span class="c1">#                markerscale=1,</span>
                <span class="c1">#                borderaxespad=.01,</span>
                <span class="c1">#                labelspacing=.07,</span>
                <span class="c1">#                handletextpad=.2,</span>
                <span class="c1">#                borderpad=.02)</span>
                <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;strike&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axst</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="c1"># --&gt; set axes properties for skew</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_skew</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skew_limits</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Skew(deg)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period(s)&#39;</span><span class="p">,</span>
                                     <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">nonposx</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                               <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>
                               <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                               <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="c1"># self.axsk.legend(sklist,</span>
                <span class="c1">#                 stationlist,</span>
                <span class="c1">#                 loc=4,</span>
                <span class="c1">#                 ncol=2,</span>
                <span class="c1">#                 markerscale=1,</span>
                <span class="c1">#                 borderaxespad=.01,</span>
                <span class="c1">#                 labelspacing=.07,</span>
                <span class="c1">#                 handletextpad=.2,</span>
                <span class="c1">#                 borderpad=.02)</span>
                <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;skew&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axsk</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="c1"># ----set axes properties for pt-----------------------------------</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_pt</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">*</span> \
                                   <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">,</span>
                                   <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlimits</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">*</span> \
                                   <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">)</span>

                <span class="n">tklabels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">tk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">tklabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">labeldict</span><span class="p">[</span><span class="n">tk</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_spacing</span><span class="p">])</span>
                        <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tk</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tklabels</span><span class="p">,</span>
                                          <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Period (s)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fontdict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span><span class="p">,</span>
                                   <span class="n">ymax</span><span class="o">=</span><span class="mf">1.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_size</span> <span class="o">*</span> <span class="p">(</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">,</span>
                               <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span>
                               <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">),</span>
                               <span class="n">lw</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="c1"># add colorbar for PT</span>
                <span class="n">axpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
                <span class="n">cb_position</span> <span class="o">=</span> <span class="p">(</span><span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">0575</span><span class="p">,</span>
                               <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">02</span><span class="p">,</span>
                               <span class="o">.</span><span class="mi">01</span><span class="p">,</span>
                               <span class="n">axpos</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">75</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">cb_position</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ellipse_cmap</span> <span class="o">==</span> <span class="s1">&#39;mt_seg_bl2wh2rd&#39;</span><span class="p">:</span>
                    <span class="c1"># make a color list</span>
                    <span class="n">clist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">),</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">))]</span> <span class="o">+</span> \
                            <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">cc</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">),</span> <span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">nseg</span><span class="p">))]</span>

                    <span class="c1"># make segmented colormap</span>
                    <span class="n">mt_seg_bl2wh2rd</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">clist</span><span class="p">)</span>

                    <span class="c1"># make bounds so that the middle is white</span>
                    <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ckmin</span> <span class="o">-</span> <span class="n">ckstep</span><span class="p">,</span> <span class="n">ckmax</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ckstep</span><span class="p">,</span> <span class="n">ckstep</span><span class="p">)</span>

                    <span class="c1"># normalize the colors</span>
                    <span class="n">norms</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">mt_seg_bl2wh2rd</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>

                    <span class="c1"># make the colorbar</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbax</span><span class="p">,</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">mt_seg_bl2wh2rd</span><span class="p">,</span>
                                                 <span class="n">norm</span><span class="o">=</span><span class="n">norms</span><span class="p">,</span>
                                                 <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                                                 <span class="n">ticks</span><span class="o">=</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span> <span class="o">=</span> <span class="n">mcb</span><span class="o">.</span><span class="n">ColorbarBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cbax</span><span class="p">,</span>
                                                 <span class="n">cmap</span><span class="o">=</span><span class="n">mtcl</span><span class="o">.</span><span class="n">cmapdict</span><span class="p">[</span><span class="n">cmap</span><span class="p">],</span>
                                                 <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">ckmin</span><span class="p">,</span>
                                                                       <span class="n">vmax</span><span class="o">=</span><span class="n">ckmax</span><span class="p">),</span>
                                                 <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="n">ckmin</span><span class="p">,</span> <span class="p">(</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ckmax</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmin</span><span class="p">),</span>
                                          <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">ckmax</span> <span class="o">-</span> <span class="n">ckmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                                          <span class="s1">&#39;</span><span class="si">{0:.0f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ckmax</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cbpt</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">mtpl</span><span class="o">.</span><span class="n">ckdict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ellipse_colorby</span><span class="p">],</span>
                                    <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">})</span>

                <span class="k">if</span> <span class="n">pdict</span><span class="p">[</span><span class="s1">&#39;pt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axpt</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotMultipleResponses.update_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotnresponses.PlotMultipleResponses.update_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        update any parameters that where changed using the built-in draw from</span>
<span class="sd">        canvas.</span>

<span class="sd">        Use this if you change an of the .fig or axes properties</span>

<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; # to change the grid lines to only be on the major ticks</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; [ax.grid(True, which=&#39;major&#39;) for ax in [p1.axr,p1.axp]]</span>
<span class="sd">            &gt;&gt;&gt; p1.update_plot()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotMultipleResponses.redraw_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotnresponses.PlotMultipleResponses.redraw_plot">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        use this function if you updated some attributes and want to re-plot.</span>

<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; # change the color and marker of the xy components</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_color = (.5,.5,.9)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_marker = &#39;*&#39;</span>
<span class="sd">            &gt;&gt;&gt; p1.redraw_plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rewrite the string builtin to give a useful message</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;Plots resistivity and phase for the different modes of the MT </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;response for multiple sites. At the moment it supports the </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;input of an .edi file. Other formats that will be supported</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;are the impedance tensor and errors with an array of periods</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> \
               <span class="s2">&quot;and .j format.</span><span class="se">\n</span><span class="s2">&quot;</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Geoscience Australia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>