
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mtpy.imaging.plotstrike &#8212; mtpy 1.01.01 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for mtpy.imaging.plotstrike</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu May 30 18:28:24 2013</span>

<span class="sd">@author: jpeacock-pr</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#==============================================================================</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">MultipleLocator</span>
<span class="kn">from</span> <span class="nn">mtpy.analysis.zinvariants</span> <span class="k">import</span> <span class="n">Zinvariants</span>
<span class="kn">import</span> <span class="nn">mtpy.imaging.mtplottools</span> <span class="k">as</span> <span class="nn">mtpl</span>


<span class="c1">#==============================================================================</span>


<div class="viewcode-block" id="PlotStrike"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotstrike.PlotStrike">[docs]</a><span class="k">class</span> <span class="nc">PlotStrike</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    PlotStrike will plot the strike estimated from the invariants, phase tensor</span>
<span class="sd">    and the tipper in either a rose diagram of xy plot</span>


<span class="sd">    plots the strike angle as determined by phase tensor azimuth (Caldwell et</span>
<span class="sd">    al. [2004]) and invariants of the impedance tensor (Weaver et al. [2003]).</span>

<span class="sd">    The data is split into decades where the histogram for each is plotted in</span>
<span class="sd">    the form of a rose diagram with a range of 0 to 180 degrees.</span>
<span class="sd">    Where 0 is North and 90 is East.   The median angle of the period band is</span>
<span class="sd">    set in polar diagram.  The top row is the strike estimated from</span>
<span class="sd">    the invariants of the impedance tensor.  The bottom row is the azimuth</span>
<span class="sd">    estimated from the phase tensor.  If tipper is &#39;y&#39; then the 3rd row is the</span>
<span class="sd">    strike determined from the tipper, which is orthogonal to the induction</span>
<span class="sd">    arrow direction.</span>

<span class="sd">    Arguments</span>
<span class="sd">    ----------</span>
<span class="sd">        **fn_list** : list of strings</span>
<span class="sd">                          full paths to .edi files to plot</span>

<span class="sd">        **z_object** : class mtpy.core.z.Z</span>
<span class="sd">                      object of mtpy.core.z.  If this is input be sure the</span>
<span class="sd">                      attribute z.freq is filled.  *default* is None</span>

<span class="sd">        **mt_object** : class mtpy.imaging.mtplot.MTplot</span>
<span class="sd">                        object of mtpy.imaging.mtplot.MTplot</span>
<span class="sd">                        *default* is None</span>

<span class="sd">        **fignum** : int</span>
<span class="sd">                     figure number to be plotted. *Default* is 1</span>

<span class="sd">        **fs** : float</span>
<span class="sd">                 font size for labels of plotting. *Default* is 10</span>

<span class="sd">        **dpi** : int</span>
<span class="sd">                  dots-per-inch resolution of figure, 300 is needed for</span>
<span class="sd">                  publications. *Default* is 300</span>

<span class="sd">        **rot_z** : float</span>
<span class="sd">                     angle of rotation clockwise positive. *Default* is 0</span>

<span class="sd">        **period_tolerance** : float</span>
<span class="sd">                   Tolerance level to match periods from different edi files.</span>
<span class="sd">                   *Default* is 0.05</span>

<span class="sd">        **text_dict** : dictionary</span>
<span class="sd">                  *&#39;pad&#39; : float</span>
<span class="sd">                           padding of the angle label at the bottom of each</span>
<span class="sd">                           polar diagram.  *Default* is 1.65</span>

<span class="sd">                  *&#39;size&#39; : float</span>
<span class="sd">                            font size</span>


<span class="sd">        **plot_range** : [ &#39;data&#39; | (period_min,period_max) ]</span>
<span class="sd">                    period range to estimate the strike angle. Options are:</span>
<span class="sd">                        * *&#39;data&#39;* for estimating the strike for all periods</span>
<span class="sd">                            in the data.</span>
<span class="sd">                        * (pmin,pmax) for period min and period max, input as</span>
<span class="sd">                          (log10(pmin),log10(pmax))</span>

<span class="sd">        **plot_type** : [ 1 | 2 ]</span>
<span class="sd">                        -*1* to plot individual decades in one plot</span>
<span class="sd">                        -*2* to plot all period ranges into one polar diagram</span>
<span class="sd">                              for each strike angle estimation</span>

<span class="sd">        **plot_tipper** : [ &#39;y&#39; | &#39;n&#39; ]</span>
<span class="sd">                      -*&#39;y&#39;* to plot the tipper strike</span>
<span class="sd">                      -*&#39;n&#39;* to not plot tipper strike</span>

<span class="sd">        **pt_error_floor** : float</span>
<span class="sd">                    Maximum error in degrees that is allowed to estimate strike.</span>
<span class="sd">                    *Default* is None allowing all estimates to be used.</span>

<span class="sd">        **fold** : [ True | False ]</span>
<span class="sd">                    *True to plot only from 0 to 180</span>
<span class="sd">                    *False to plot from 0 to 360</span>


<span class="sd">    :Example: ::</span>

<span class="sd">        &gt;&gt;&gt; import os</span>
<span class="sd">        &gt;&gt;&gt; import mtpy.imaging.mtplot as mtplot</span>
<span class="sd">        &gt;&gt;&gt; edipath = r&quot;/home/EDIFiles&quot;</span>
<span class="sd">        &gt;&gt;&gt; edilist = [os.path.join(edipath,edi) for edi in os.listdir(edipath)</span>
<span class="sd">        &gt;&gt;&gt; ...       if edi.find(&#39;.edi&#39;)&gt;0]</span>
<span class="sd">        &gt;&gt;&gt; #---plot rose plots in decades with tipper and an error floor on pt</span>
<span class="sd">        &gt;&gt;&gt; strike = mtplot.plot_strike(fn_list=edilist, plot_type=1,\</span>
<span class="sd">                                        pt_error_floor=5)</span>
<span class="sd">        &gt;&gt;&gt; #---plot all decades into one rose plot for each estimation---</span>
<span class="sd">        &gt;&gt;&gt; strike.plot_type = 2</span>
<span class="sd">        &gt;&gt;&gt; strike.redraw_plot()</span>
<span class="sd">        &gt;&gt;&gt; #---save the plot---</span>
<span class="sd">        &gt;&gt;&gt; strike.save_plot(r&quot;/home/Figures&quot;)</span>
<span class="sd">        &#39;Figure saved to /home/Figures/StrikeAnalysis_.pdf&#39;</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>

<span class="sd">        -axhinv            matplotlib.axes instance for invariant strike</span>
<span class="sd">        -axhpt             matplotlib.axes instance for phase tensor strike</span>
<span class="sd">        -axhtip            matplotlib.axes instance for tipper strike</span>

<span class="sd">        -barinv            matplotlib.axes.bar instance for invariant strike</span>
<span class="sd">        -barpt             matplotlib.axes.bar instance for pt strike</span>
<span class="sd">        -bartr             matplotlib.axes.bar instance for tipper strike</span>

<span class="sd">        -bin_width         width of histogram bins in degrees</span>

<span class="sd">        -fig               matplotlib.figure instance of plot</span>
<span class="sd">        -fig_dpi           dots-per-inch resolution of figure</span>
<span class="sd">        -fig_num           number of figure being plotted</span>
<span class="sd">        -fig_size          size of figure in inches</span>
<span class="sd">        -fold              boolean to fold angles to range from [0,180] or</span>
<span class="sd">                           [0,360]</span>

<span class="sd">        -font_size         font size of axes tick labels</span>

<span class="sd">        -mt_list            list of mtplot.MTplot instances containing all</span>
<span class="sd">                           the important information for each station</span>
<span class="sd">        -period_tolerance  tolerance to look for periods being plotted</span>

<span class="sd">        -plot_range        range of periods to plot</span>
<span class="sd">        -plot_tipper       string to tell program to plot induction arrows</span>
<span class="sd">        -plot_type         string to tell program how to plot strike angles</span>
<span class="sd">        -plot_yn           plot strike on instance creation</span>
<span class="sd">        -pt_error_floor    error floor to plot phase tensor strike, anything</span>
<span class="sd">                           above this error will not be plotted</span>
<span class="sd">        -text_pad          padding between text and rose diagram</span>
<span class="sd">        -text_size         font size of text labeling the mode of the histogram</span>
<span class="sd">        -title_dict        title dictionary</span>

<span class="sd">    Methods</span>
<span class="sd">    --------</span>

<span class="sd">        -plot                 plots the pseudo section</span>
<span class="sd">        -redraw_plot          on call redraws the plot from scratch</span>
<span class="sd">        -save_figure          saves figure to a file of given format</span>
<span class="sd">        -update_plot          updates the plot while still active</span>
<span class="sd">        -export_pt_params_to_file       writes parameters of the phase tensor and tipper</span>
<span class="sd">                              to text files.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">fn_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fn_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">z_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;z_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">tipper_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;tipper_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mt_object_list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;mt_object_list&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1">#------Set attributes of the class-----------------</span>

        <span class="c1">#--&gt; get the inputs into a list of mt objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span> <span class="o">=</span> <span class="n">mtpl</span><span class="o">.</span><span class="n">get_mtlist</span><span class="p">(</span><span class="n">fn_list</span><span class="o">=</span><span class="n">fn_list</span><span class="p">,</span>
                                       <span class="n">z_object_list</span><span class="o">=</span><span class="n">z_object_list</span><span class="p">,</span>
                                       <span class="n">tipper_object_list</span><span class="o">=</span><span class="n">tipper_object_list</span><span class="p">,</span>
                                       <span class="n">mt_object_list</span><span class="o">=</span><span class="n">mt_object_list</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rot_z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="c1"># if the rotation angle is an array for rotation of different</span>
        <span class="c1"># freq than repeat that rotation array to the len(mt_list)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#--&gt; set plot properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_dpi&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fig_size&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_num</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_num&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_type&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_range&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_tipper&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">period_tolerance</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;period_tolerance&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">05</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pt_error_floor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pt_error_floor&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fold&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bin_width</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;bin_width&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;font_size&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">text_dict</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;text_dict&#39;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_pad</span> <span class="o">=</span> <span class="n">text_dict</span><span class="p">[</span><span class="s1">&#39;pad&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_pad</span> <span class="o">=</span> <span class="mf">0.6</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span> <span class="o">=</span> <span class="n">text_dict</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>

        <span class="c1"># make a dictionary for plotting titles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^{-5}$--10$^{-4}$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^{-4}$--10$^{-3}$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^{-3}$--10$^{-2}$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^{-2}$--10$^{-1}$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^{-1}$--10$^</span><span class="si">{0}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{0}</span><span class="s1">$--10$^</span><span class="si">{1}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{1}</span><span class="s1">$--10$^</span><span class="si">{2}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{2}</span><span class="s1">$--10$^</span><span class="si">{3}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{3}</span><span class="s1">$--10$^</span><span class="si">{4}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{4}</span><span class="s1">$--10$^</span><span class="si">{5}</span><span class="s1">$s&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;10$^</span><span class="si">{5}</span><span class="s1">$--10$^</span><span class="si">{6}</span><span class="s1">$s&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;plot_yn&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_yn</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

    <span class="c1">#---need to rotate data on setting rotz</span>
    <span class="k">def</span> <span class="nf">_set_rot_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_z</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        need to rotate data when setting z</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># if rotation angle is an int or float make an array the length of</span>
        <span class="c1"># mt_list for plotting purposes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rot_z</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="c1"># if the rotation angle is an array for rotation of different</span>
        <span class="c1"># freq than repeat that rotation array to the len(mt_list)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">rot_z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">rot_z</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>
            <span class="n">mt</span><span class="o">.</span><span class="n">rot_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_get_rot_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rot_z</span>

    <span class="n">rot_z</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">fget</span><span class="o">=</span><span class="n">_get_rot_z</span><span class="p">,</span> <span class="n">fset</span><span class="o">=</span><span class="n">_set_rot_z</span><span class="p">,</span>
                     <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;rotation angle(s)&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">07</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">09</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">90</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">4</span>

        <span class="n">bw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_width</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">histrange</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">histrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>

        <span class="c1"># set empty lists that will hold dictionaries with keys as the period</span>
        <span class="n">invlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ptlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tiprlist</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># initialize some parameters</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">)</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">kk</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">dd</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">):</span>

            <span class="c1">#--&gt; set the period</span>
            <span class="n">period</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">period</span>

            <span class="c1"># get maximum length of periods</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">nt</span><span class="p">:</span>
                <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">period</span><span class="p">)</span>

            <span class="c1">#-----------get strike angle from invariants-----------------------</span>
            <span class="n">zinv</span> <span class="o">=</span> <span class="n">Zinvariants</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>

            <span class="c1"># add 90 degrees because invariants assume 0 is north, but plotting</span>
            <span class="c1"># assumes that 90 is north and measures clockwise, thus the negative</span>
            <span class="c1"># because the strike angle from invariants is measured</span>
            <span class="c1"># counter-clockwise</span>

            <span class="n">zs</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">zinv</span><span class="o">.</span><span class="n">strike</span>

            <span class="c1"># fold so the angle goes from 0 to 180</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="c1"># for plotting put the NW angles into the SE quadrant</span>
                <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

            <span class="c1"># leave as the total unit circle 0 to 360</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">360</span>
                <span class="c1">#zs = 360-zs</span>

            <span class="c1"># make a dictionary of strikes with keys as period</span>
            <span class="n">mdictinv</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">ff</span><span class="p">,</span> <span class="n">jj</span><span class="p">)</span> <span class="k">for</span> <span class="n">ff</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="n">zs</span><span class="p">)])</span>
            <span class="n">invlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdictinv</span><span class="p">)</span>

            <span class="c1">#------------get strike from phase tensor strike angle-------------</span>
            <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>
            <span class="n">az</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span>
            <span class="n">az_err</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth_err</span>

            <span class="c1"># need to add 90 because pt assumes 0 is north and</span>
            <span class="c1"># negative because measures clockwise.</span>

            <span class="c1"># put an error max on the estimation of strike angle</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pt_error_floor</span><span class="p">:</span>
                <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az_err</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pt_error_floor</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># fold so the angle goes from 0 to 180</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span><span class="p">:</span>
                <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

            <span class="c1"># leave as the total unit circle 0 to 360</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># make a dictionary of strikes with keys as period</span>
            <span class="n">mdictpt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">ff</span><span class="p">,</span> <span class="n">jj</span><span class="p">)</span> <span class="k">for</span> <span class="n">ff</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="n">az</span><span class="p">)])</span>
            <span class="n">ptlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mdictpt</span><span class="p">)</span>

            <span class="c1">#-----------get tipper strike------------------------------------</span>
            <span class="n">tip</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span>
            <span class="k">if</span> <span class="n">tip</span><span class="o">.</span><span class="n">tipper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tip</span><span class="o">.</span><span class="n">tipper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
                <span class="n">tip</span><span class="o">.</span><span class="n">compute_components</span><span class="p">()</span>

            <span class="c1"># needs to be negative because measures clockwise</span>
            <span class="n">tipr</span> <span class="o">=</span> <span class="o">-</span><span class="n">tip</span><span class="o">.</span><span class="n">angle_real</span>

            <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">==</span> <span class="mf">180.</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># fold so the angle goes from 0 to 180</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-=</span> <span class="mi">180</span>
                <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">180</span>

            <span class="c1"># leave as the total unit circle 0 to 360</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">360</span>
                <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">==</span> <span class="mf">360.0</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="c1"># make a dictionary of strikes with keys as period</span>
            <span class="n">tiprdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">ff</span><span class="p">,</span> <span class="n">jj</span><span class="p">)</span> <span class="k">for</span> <span class="n">ff</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">,</span> <span class="n">tipr</span><span class="p">)])</span>
            <span class="n">tiprlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tiprdict</span><span class="p">)</span>

        <span class="c1">#--&gt; get min and max period</span>
        <span class="n">maxper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">invlist</span><span class="p">])</span>
        <span class="n">minper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">ptlist</span><span class="p">])</span>

        <span class="c1"># make empty arrays to put data into for easy manipulation</span>
        <span class="n">medinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
        <span class="n">medpt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>
        <span class="n">medtipr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nt</span><span class="p">,</span> <span class="n">nc</span><span class="p">))</span>

        <span class="c1"># make a list of periods from the longest period list</span>
        <span class="n">plist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">minper</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">maxper</span><span class="p">),</span>
            <span class="n">num</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span>
            <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">pdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">)</span> <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plist</span><span class="p">)])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_plist</span> <span class="o">=</span> <span class="n">plist</span>

        <span class="c1"># put data into arrays</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">invlist</span><span class="p">):</span>
            <span class="n">mperiod</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">mp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mperiod</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">pdict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">mp</span> <span class="o">&gt;</span> <span class="n">kk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">period_tolerance</span><span class="p">)</span> <span class="ow">and</span> \
                            <span class="n">mp</span> <span class="o">&lt;</span> <span class="n">kk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">period_tolerance</span><span class="p">):</span>
                        <span class="n">ll</span> <span class="o">=</span> <span class="n">pdict</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
                        <span class="n">medinv</span><span class="p">[</span><span class="n">ll</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">invlist</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">mp</span><span class="p">]</span>
                        <span class="n">medpt</span><span class="p">[</span><span class="n">ll</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">ptlist</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">mp</span><span class="p">]</span>
                        <span class="n">medtipr</span><span class="p">[</span><span class="n">ll</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">tiprlist</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">mp</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">pass</span>

        <span class="c1"># make the arrays local variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_medinv</span> <span class="o">=</span> <span class="n">medinv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_medpt</span> <span class="o">=</span> <span class="n">medpt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_medtp</span> <span class="o">=</span> <span class="n">medtipr</span>

        <span class="c1">#-----Plot Histograms of the strike angles-----------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_range</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">brange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">minper</span><span class="p">)),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">maxper</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">brange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_brange</span> <span class="o">=</span> <span class="n">brange</span>

        <span class="c1"># font dictionary</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">}</span>

        <span class="c1">#------------------plot indivdual decades------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># plot specs</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">3</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">3</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">brange</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">bb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">brange</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># make subplots for invariants and phase tensor azimuths</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nb</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span>
                        <span class="mi">2</span><span class="p">,</span> <span class="n">nb</span><span class="p">,</span> <span class="n">jj</span> <span class="o">+</span> <span class="n">nb</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">axlist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="p">]</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">nb</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span>
                        <span class="mi">3</span><span class="p">,</span> <span class="n">nb</span><span class="p">,</span> <span class="n">jj</span> <span class="o">+</span> <span class="n">nb</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">nb</span><span class="p">,</span> <span class="n">jj</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nb</span><span class="p">,</span>
                                                       <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">axlist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span><span class="p">]</span>

                <span class="c1"># make a list of indicies for each decades</span>
                <span class="n">binlist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">ff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">ff</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">bb</span> <span class="ow">and</span> <span class="n">ff</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">bb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">binlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>

                <span class="c1"># extract just the subset for each decade</span>
                <span class="n">hh</span> <span class="o">=</span> <span class="n">medinv</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">gg</span> <span class="o">=</span> <span class="n">medpt</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                    <span class="n">tr</span> <span class="o">=</span> <span class="n">medtipr</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>

                    <span class="c1"># compute the historgram for the tipper strike</span>
                    <span class="n">trhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                          <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                          <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

                    <span class="c1"># make a bar graph with each bar being width of bw degrees</span>
                    <span class="n">bartr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">trhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                            <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                    <span class="c1"># set color of the bars according to the number in that bin</span>
                    <span class="c1"># tipper goes from dark blue (low) to light blue (high)</span>
                    <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bartr</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">9</span>
                            <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fc</span><span class="p">))</span>
                        <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                            <span class="k">pass</span>

                <span class="c1"># estimate the histogram for the decade for invariants and pt</span>
                <span class="n">invhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                       <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                       <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>
                <span class="n">pthist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                      <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

                <span class="c1"># plot the histograms</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">barinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">invhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                              <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                              <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">barpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">pthist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                            <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                <span class="c1"># set the color of the bars according to the number in that bin</span>
                <span class="c1"># invariants go from purple (low) to red (high)</span>
                <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barinv</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span>
                        <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                        <span class="k">pass</span>

                <span class="c1"># pt goes from green (low) to orange (high)</span>
                <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barpt</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span>
                        <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="n">fc</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                        <span class="k">pass</span>

                <span class="c1"># make axis look correct with N to the top at 90.</span>
                <span class="k">for</span> <span class="n">aa</span><span class="p">,</span> <span class="n">axh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axlist</span><span class="p">):</span>
                    <span class="c1"># set multiple locator to be every 15 degrees</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span>
                        <span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">))</span>

                    <span class="c1"># set labels on the correct axis</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                              <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>
                    <span class="c1"># make a light grid</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=.</span><span class="mi">25</span><span class="p">)</span>

                    <span class="c1"># properties for the invariants</span>
                    <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># limits need to be rotate 90 counter clockwise because</span>
                        <span class="c1"># we already rotated by 90 degrees so the range is</span>
                        <span class="c1"># from -90 to 270 with -90 being east</span>
                        <span class="n">axh</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">270</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                        <span class="c1"># label the plot with the mode value of strike</span>
                        <span class="c1"># need to subtract 90 again because the histogram is</span>
                        <span class="c1"># for ploting 0 east, 90 north measuring</span>
                        <span class="c1"># counter-clockwise</span>
                        <span class="n">invmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                            <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="k">if</span> <span class="n">invmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">invmode</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_pad</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">invmode</span><span class="p">),</span>
                                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                                 <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">},</span>
                                 <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                        <span class="c1"># print out the statistics of the strike angles</span>
                        <span class="n">invmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">invmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">invmedian</span> <span class="o">+=</span> <span class="mi">360</span>
                        <span class="n">invmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">invmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">invmean</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="nb">print</span> <span class="s1">&#39;-----Period Range </span><span class="si">{0:.3g}</span><span class="s1"> to </span><span class="si">{1:.3g}</span><span class="s1"> (s)-----&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">bb</span><span class="p">,</span>
                                                                                     <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">bb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

                        <span class="nb">print</span> <span class="s1">&#39;   *Z-Invariants:  median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">invmedian</span><span class="p">,</span>
                            <span class="n">invmode</span><span class="p">,</span>
                            <span class="n">invmode</span><span class="p">)</span>

                        <span class="c1">#--&gt; set title of subplot</span>
                        <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="n">bb</span><span class="p">],</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                      <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                        <span class="c1">#--&gt; set the title offset</span>
                        <span class="n">axh</span><span class="o">.</span><span class="n">titleOffsetTrans</span><span class="o">.</span><span class="n">_t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>

                    <span class="c1"># set pt axes properties</span>
                    <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="c1"># limits go from -180 to 180 as that is how the angle</span>
                        <span class="c1"># is calculated</span>
                        <span class="n">axh</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                        <span class="c1"># label plot with the mode of the strike angle</span>
                        <span class="n">ptmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                            <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="k">if</span> <span class="n">ptmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">ptmode</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">ptmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">ptmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">ptmedian</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">ptmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">ptmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">ptmean</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_pad</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ptmode</span><span class="p">),</span>
                                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                                 <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">},</span>
                                 <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                        <span class="c1"># print out the results for the strike angles</span>

                        <span class="nb">print</span> <span class="s1">&#39;   *PT Strike:     median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">ptmedian</span><span class="p">,</span>
                            <span class="n">ptmode</span><span class="p">,</span>
                            <span class="n">ptmean</span><span class="p">)</span>

                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">!=</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                            <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

                        <span class="k">if</span> <span class="n">nb</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                            <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="n">bb</span><span class="p">],</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                          <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                    <span class="c1"># set tipper axes properties</span>
                    <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="c1"># limits go from -180 to 180</span>
                        <span class="n">axh</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                        <span class="c1"># label plot with mode</span>
                        <span class="n">tpmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                            <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="k">if</span> <span class="n">tpmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">tpmode</span> <span class="o">+=</span> <span class="mf">360.</span>

                        <span class="n">tpmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">tpmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">tpmedian</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">tpmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)])</span>
                        <span class="k">if</span> <span class="n">tpmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">tpmean</span> <span class="o">+=</span> <span class="mi">360</span>

                        <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_pad</span><span class="p">,</span>
                                 <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tpmode</span><span class="p">),</span>
                                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                 <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                                 <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">},</span>
                                 <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                        <span class="c1"># print out statistics for strike angle</span>
                        <span class="nb">print</span> <span class="s1">&#39;   *Tipper Strike: median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">tpmedian</span><span class="p">,</span>
                            <span class="n">tpmode</span><span class="p">,</span>
                            <span class="n">tpmode</span><span class="p">)</span>
                        <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="k">if</span> <span class="n">nb</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                            <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="n">bb</span><span class="p">],</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                          <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                    <span class="c1"># set plot labels</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">axh</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Strike (Z)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                           <span class="n">labelpad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                           <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span>
                                                 <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>
                        <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">axh</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PT Azimuth&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                           <span class="n">labelpad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                           <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                                 <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>
                        <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">axh</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Tipper Strike&#39;</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span>
                                           <span class="n">labelpad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">,</span>
                                           <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">),</span>
                                                 <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>

                    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axh</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="nb">print</span> <span class="s1">&#39;Note: North is assumed to be 0 and the strike angle is measured&#39;</span> <span class="o">+</span>\
                  <span class="s1">&#39;clockwise positive.&#39;</span>

            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="c1">#------------------Plot strike angles for all period ranges------------</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># plot specs</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.left&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">07</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">98</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.bottom&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">100</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">88</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.hspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">3</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.subplot.wspace&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">2</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_num</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">fig_size</span><span class="p">,</span>
                                  <span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="c1"># make subplots for invariants and phase tensor azimuths</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span> <span class="c1"># polar=True)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span> <span class="c1"># polar=True)</span>
                <span class="n">axlist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">axlist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span><span class="p">]</span>

            <span class="c1"># make a list of indicies for each decades</span>
            <span class="n">binlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">pdict</span><span class="p">[</span><span class="n">ff</span><span class="p">]</span> <span class="k">for</span> <span class="n">ff</span> <span class="ow">in</span> <span class="n">plist</span>
                       <span class="k">if</span> <span class="n">ff</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">brange</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="ow">and</span> <span class="n">ff</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">brange</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>

            <span class="c1"># extract just the subset for each decade</span>
            <span class="n">hh</span> <span class="o">=</span> <span class="n">medinv</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">gg</span> <span class="o">=</span> <span class="n">medpt</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>

            <span class="c1"># estimate the histogram for the decade for invariants and pt</span>
            <span class="n">invhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                   <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                   <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>
            <span class="n">pthist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                  <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                  <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

            <span class="c1"># plot the histograms</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">barinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhinv</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">invhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                          <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">barpt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhpt</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">pthist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                        <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

            <span class="c1"># set color of invariants from purple (low) to red (high count)</span>
            <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barinv</span><span class="p">):</span>
                <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span><span class="p">))</span>

            <span class="c1"># set color of pt from green (low) to orange (high count)</span>
            <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">barpt</span><span class="p">):</span>
                <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">8</span>
                <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="n">fc</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="c1"># plot tipper if desired</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_medtp</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>

                <span class="n">trhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                      <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">bartr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axhtip</span><span class="o">.</span><span class="n">bar</span><span class="p">((</span><span class="n">trhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                                             <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                             <span class="n">width</span><span class="o">=</span><span class="n">bw</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>

                <span class="c1"># set tipper color from dark blue (low) to light blue (high)</span>
                <span class="k">for</span> <span class="n">cc</span><span class="p">,</span> <span class="n">bar</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bartr</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">fc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">cc</span><span class="p">])</span> <span class="o">/</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="o">.</span><span class="mi">9</span>
                        <span class="n">bar</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fc</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fc</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="c1"># make axis look correct with N to the top at 90.</span>
            <span class="k">for</span> <span class="n">aa</span><span class="p">,</span> <span class="n">axh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axlist</span><span class="p">):</span>
                <span class="c1"># set major ticks to be every 30 degrees</span>
                <span class="n">axh</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">))</span>

                <span class="c1"># set a light grid</span>
                <span class="n">axh</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>  <span class="c1"># works in 2.0.2 not 2.1.0</span>

                <span class="c1"># set tick labels to be invisible</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axh</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_ticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># works in 2.0.2 not 2.1.0</span>

                <span class="c1"># place the correct label at the cardinal directions</span>
                <span class="n">axh</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>

                <span class="c1"># set invariant axes propertiesz</span>
                <span class="k">if</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

                    <span class="n">invmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                        <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                    <span class="k">if</span> <span class="n">invmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invmode</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">170</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span>
                             <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">invmode</span><span class="p">),</span>
                             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                             <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">font_size</span><span class="p">},</span>
                             <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">.</span><span class="mi">25</span><span class="p">})</span>

                    <span class="c1"># print out the statistics of the strike angles</span>
                    <span class="n">invmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">invmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invmedian</span> <span class="o">+=</span> <span class="mi">360</span>
                    <span class="n">invmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">invmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invmean</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="nb">print</span> <span class="s1">&#39;-----Period Range </span><span class="si">{0:.3g}</span><span class="s1"> to </span><span class="si">{1:.3g}</span><span class="s1"> (s)-----&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="n">brange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                                 <span class="mi">10</span><span class="o">**</span><span class="n">brange</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                    <span class="nb">print</span> <span class="s1">&#39;   *Z-Invariants:  median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">invmedian</span><span class="p">,</span>
                        <span class="n">invmode</span><span class="p">,</span>
                        <span class="n">invmode</span><span class="p">)</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Strike (Z)&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                  <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>

                <span class="c1"># set pt axes properties</span>
                <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

                    <span class="n">ptmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                        <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                    <span class="k">if</span> <span class="n">ptmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptmode</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="k">if</span> <span class="n">ptmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptmode</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">ptmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">ptmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptmedian</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">ptmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">ptmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptmean</span> <span class="o">+=</span> <span class="mi">90</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">170</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span>
                             <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ptmode</span><span class="p">),</span>
                             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                             <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">},</span>
                             <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>

                    <span class="c1"># print results of strike analysis for pt</span>
                    <span class="nb">print</span> <span class="s1">&#39;   *PT Strike:     median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">ptmedian</span><span class="p">,</span>
                        <span class="n">ptmode</span><span class="p">,</span>
                        <span class="n">ptmean</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_tipper</span> <span class="o">!=</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
                        <span class="nb">print</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PT Azimuth&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                  <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>

                <span class="c1"># set tipper axes properties</span>
                <span class="k">elif</span> <span class="n">aa</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">axh</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

                    <span class="n">tpmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                        <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

                    <span class="k">if</span> <span class="n">tpmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpmode</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">tpmedian</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">tpmedian</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpmedian</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">tpmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)])</span>
                    <span class="k">if</span> <span class="n">tpmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpmean</span> <span class="o">+=</span> <span class="mi">360</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">170</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span> <span class="n">axh</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span>
                             <span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">$^o$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tpmode</span><span class="p">),</span>
                             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                             <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;baseline&#39;</span><span class="p">,</span>
                             <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_size</span><span class="p">},</span>
                             <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>
                    <span class="nb">print</span> <span class="s1">&#39;   *Tipper Stike:  median=</span><span class="si">{0:.1f}</span><span class="s1"> mode=</span><span class="si">{1:.1f}</span><span class="s1"> mean=</span><span class="si">{2:.1f}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">tpmedian</span><span class="p">,</span>
                        <span class="n">tpmode</span><span class="p">,</span>
                        <span class="n">tpmean</span><span class="p">)</span>

                    <span class="n">axh</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Tipper Strike&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="n">fd</span><span class="p">,</span>
                                  <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>

                <span class="c1"># move title up a little to make room for labels</span>
                <span class="n">axh</span><span class="o">.</span><span class="n">titleOffsetTrans</span><span class="o">.</span><span class="n">_t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">)</span>

            <span class="c1"># remind the user what the assumptions of the strike angle are</span>
            <span class="nb">print</span> <span class="s1">&#39;Note: North is assumed to be 0 and the strike angle is &#39;</span> <span class="o">+</span>\
                  <span class="s1">&#39;measured clockwise positive.&#39;</span>
            <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<div class="viewcode-block" id="PlotStrike.save_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotstrike.PlotStrike.save_plot">[docs]</a>    <span class="k">def</span> <span class="nf">save_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_fn</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span>
                  <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span> <span class="n">fig_dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">close_plot</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save_plot will save the figure to save_fn.</span>

<span class="sd">        Arguments</span>
<span class="sd">        -----------</span>

<span class="sd">            **save_fn** : string</span>
<span class="sd">                          full path to save figure to, can be input as</span>
<span class="sd">                          - directory path -&gt; the directory path to save to</span>
<span class="sd">                            in which the file will be saved as</span>
<span class="sd">                            save_fn/station_name_ResPhase.file_format</span>

<span class="sd">                          - full path -&gt; file will be save to the given</span>
<span class="sd">                            path.  If you use this option then the format</span>
<span class="sd">                            will be assumed to be provided by the path</span>

<span class="sd">            **file_format** : [ pdf | eps | jpg | png | svg ]</span>
<span class="sd">                              file type of saved figure pdf,svg,eps...</span>

<span class="sd">            **orientation** : [ landscape | portrait ]</span>
<span class="sd">                              orientation in which the file will be saved</span>
<span class="sd">                              *default* is portrait</span>

<span class="sd">            **fig_dpi** : int</span>
<span class="sd">                          The resolution in dots-per-inch the file will be</span>
<span class="sd">                          saved.  If None then the dpi will be that at</span>
<span class="sd">                          which the figure was made.  I don&#39;t think that</span>
<span class="sd">                          it can be larger than dpi of the figure.</span>

<span class="sd">            **close_plot** : [ y | n ]</span>
<span class="sd">                             -&#39;y&#39; will close the plot after saving.</span>
<span class="sd">                             -&#39;n&#39; will leave plot open</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>

<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; # to save plot as jpg</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotPhaseTensorMaps(edilist,freqspot=10)</span>
<span class="sd">            &gt;&gt;&gt; p1.save_plot(r&#39;/home/MT&#39;, file_format=&#39;jpg&#39;)</span>
<span class="sd">            &#39;Figure saved to /home/MT/PTMaps/PTmap_phimin_10Hz.jpg&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get rid of . in file format as it will be added later</span>
        <span class="k">if</span> <span class="n">file_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="n">file_format</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fig_dpi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig_dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_dpi</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">save_fn</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">file_format</span> <span class="o">=</span> <span class="n">save_fn</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">,</span>
                             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>
            <span class="c1"># plt.clf()</span>
            <span class="c1"># plt.close(self.fig)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_fn</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">save_fn</span><span class="p">)</span>

            <span class="n">save_fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="s1">&#39;StrikeAnalysis.&#39;</span> <span class="o">+</span> <span class="n">file_format</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fn</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">fig_dpi</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">file_format</span><span class="p">,</span>
                             <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">close_plot</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig_fn</span> <span class="o">=</span> <span class="n">save_fn</span>
        <span class="nb">print</span> <span class="s1">&#39;Saved figure to: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig_fn</span></div>

<div class="viewcode-block" id="PlotStrike.update_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotstrike.PlotStrike.update_plot">[docs]</a>    <span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        update any parameters that where changed using the built-in draw from</span>
<span class="sd">        canvas.</span>

<span class="sd">        Use this if you change an of the .fig or axes properties</span>

<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; # to change the grid lines to only be on the major ticks</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; [ax.grid(True, which=&#39;major&#39;) for ax in [p1.axr,p1.axp]]</span>
<span class="sd">            &gt;&gt;&gt; p1.update_plot()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="PlotStrike.redraw_plot"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotstrike.PlotStrike.redraw_plot">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        use this function if you updated some attributes and want to re-plot.</span>

<span class="sd">        :Example: ::</span>

<span class="sd">            &gt;&gt;&gt; # change the color and marker of the xy components</span>
<span class="sd">            &gt;&gt;&gt; import mtpy.imaging.mtplottools as mtplot</span>
<span class="sd">            &gt;&gt;&gt; p1 = mtplot.PlotResPhase(r&#39;/home/MT/mt01.edi&#39;)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_color = (.5,.5,.9)</span>
<span class="sd">            &gt;&gt;&gt; p1.xy_marker = &#39;*&#39;</span>
<span class="sd">            &gt;&gt;&gt; p1.redraw_plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        rewrite the string builtin to give a useful message</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;Plots phase tensor maps for one freq&quot;</span>

<div class="viewcode-block" id="PlotStrike.writeTextFiles"><a class="viewcode-back" href="../../../imaging.html#mtpy.imaging.plotstrike.PlotStrike.writeTextFiles">[docs]</a>    <span class="k">def</span> <span class="nf">writeTextFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the strike information as a text file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check to see if the strikes have been calculated</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_width</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

        <span class="c1"># get the path to save the file to</span>
        <span class="k">if</span> <span class="n">save_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">svpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fn</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s1">&#39;Need to input save_path, could not find path&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">svpath</span> <span class="o">=</span> <span class="n">save_path</span>

        <span class="c1"># set</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">histrange</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">histrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>

        <span class="c1"># set the bin width</span>
        <span class="n">bw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_width</span>

        <span class="n">slistinv</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;station&#39;</span><span class="p">]]</span>
        <span class="n">slistpt</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;station&#39;</span><span class="p">]]</span>
        <span class="n">slisttip</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;station&#39;</span><span class="p">]]</span>

        <span class="c1"># calculate the strikes for the different period bands</span>
        <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">bb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_brange</span><span class="p">):</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_dict</span><span class="p">[</span><span class="n">bb</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="n">tstr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="n">tstr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;(s)&#39;</span><span class="p">)</span>
            <span class="n">slistinv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tstr</span><span class="p">)</span>
            <span class="n">slistpt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tstr</span><span class="p">)</span>
            <span class="n">slisttip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tstr</span><span class="p">)</span>

            <span class="c1"># calculate the strike for the different period bands per station</span>
            <span class="k">for</span> <span class="n">kk</span><span class="p">,</span> <span class="n">mt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mt_list</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">slistinv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">])</span>
                    <span class="n">slistpt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">])</span>
                    <span class="n">slisttip</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">mt</span><span class="o">.</span><span class="n">station</span><span class="p">])</span>

                <span class="n">zinv</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">invariants</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">pt</span>
                <span class="n">tp</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Tipper</span>

                <span class="n">bnlist</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">nn</span><span class="p">,</span> <span class="n">per</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">per</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">bb</span> <span class="ow">and</span> <span class="n">per</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">bb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">bnlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>

                <span class="c1">#---&gt; strike from invariants</span>
                <span class="n">zs</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">zinv</span><span class="o">.</span><span class="n">strike</span><span class="p">[</span><span class="n">bnlist</span><span class="p">]</span>
                <span class="c1"># fold so the angle goes from 0 to 180</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="c1"># for plotting put the NW angles into the SE quadrant</span>
                    <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-</span> <span class="mi">180</span>
                    <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zs</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">180</span>

                <span class="c1"># leave as the total unit circle 0 to 360</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="k">pass</span>

                <span class="n">zshist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">zs</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                      <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

                <span class="c1">#==============================================================</span>
                <span class="c1"># For putting the values into a useful text file</span>
                <span class="c1"># need to subtract 90 from the values to put them into</span>
                <span class="c1"># coordinates where north is 0 and east is 90, which is</span>
                <span class="c1"># different from plotting where east in the plotting function</span>
                <span class="c1"># is equal to 0 and north is 90, measuring counter-clockwise</span>
                <span class="c1">#==============================================================</span>

                <span class="c1">#==&gt; compute mean</span>
                <span class="n">invmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">zs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">invmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invmean</span> <span class="o">+=</span> <span class="mi">360</span>
                <span class="n">invmed</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>

                <span class="c1">#==&gt; compute median</span>
                <span class="k">if</span> <span class="n">invmed</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invmed</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1">#==&gt; compute mode</span>
                <span class="n">invmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">zshist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">zshist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">zshist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">invmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invmode</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1">#==&gt; append to list</span>
                <span class="n">slistinv</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">invmean</span><span class="p">,</span>
                                     <span class="n">invmed</span><span class="p">,</span>
                                     <span class="n">invmode</span><span class="p">))</span>

                <span class="c1">#---&gt; strike from phase tensor</span>
                <span class="n">az</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">azimuth</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">bnlist</span><span class="p">]</span>
                <span class="c1"># fold so the angle goes from 0 to 180</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">=</span> <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-</span> <span class="mi">180</span>
                    <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">=</span> <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">180</span>

                <span class="c1"># leave as the total unit circle 0 to 360</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">az</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">360</span>

                <span class="c1"># == &gt; compute mean</span>
                <span class="n">ptmean1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">az</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">ptmean1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptmean1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1"># == &gt; compute median</span>
                <span class="n">ptmed1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ptmed1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptmed1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1"># == &gt; compute mode</span>
                <span class="n">azhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">az</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">az</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                      <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>
                <span class="n">ptmode1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">azhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">azhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">azhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">ptmode1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptmode1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="n">slistpt</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ptmean1</span><span class="p">,</span>
                                    <span class="n">ptmed1</span><span class="p">,</span>
                                    <span class="n">ptmode1</span><span class="p">))</span>

                <span class="c1">#---&gt; strike from tipper</span>
                <span class="c1"># needs to be negative because measures clockwise</span>
                <span class="k">if</span> <span class="n">tp</span><span class="o">.</span><span class="n">_Tipper</span><span class="o">.</span><span class="n">tipper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">tp</span><span class="o">.</span><span class="n">_Tipper</span><span class="o">.</span><span class="n">tipper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">period</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                                 <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex&#39;</span><span class="p">)</span>
                    <span class="n">tp</span><span class="o">.</span><span class="n">compute_components</span><span class="p">()</span>

                <span class="n">tipr</span> <span class="o">=</span> <span class="o">-</span><span class="n">tp</span><span class="o">.</span><span class="n">angle_real</span><span class="p">[</span><span class="n">bnlist</span><span class="p">]</span>

                <span class="c1"># fold so the angle goes from 0 to 180</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)]</span> <span class="o">-</span> <span class="mi">180</span>
                    <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)</span>
                         <span class="p">]</span> <span class="o">=</span> <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">90</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">180</span>

                <span class="c1"># leave as the total unit circle 0 to 360</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fold</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tipr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">+</span> <span class="mi">360</span>

                <span class="n">tphist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tipr</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                      <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                      <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

                <span class="c1">#==&gt; compute mean</span>
                <span class="n">tpmean1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">tipr</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">tpmean1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpmean1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1">#==&gt; compute median</span>
                <span class="n">tpmed1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tipr</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">tpmed1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpmed1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1">#==&gt; compute mode</span>
                <span class="n">tpmode1</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">tphist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">tphist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">tphist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">tpmode1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpmode1</span> <span class="o">+=</span> <span class="mi">360</span>

                <span class="c1">#--&gt; append statistics to list</span>
                <span class="n">slisttip</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tpmean1</span><span class="p">,</span>
                                     <span class="n">tpmed1</span><span class="p">,</span>
                                     <span class="n">tpmode1</span><span class="p">))</span>

            <span class="c1"># make a list of indicies for each decades</span>
            <span class="n">binlist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">ff</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_plist</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ff</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">**</span><span class="n">bb</span> <span class="ow">and</span> <span class="n">ff</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">bb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">binlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>

            <span class="c1"># extract just the subset for each decade</span>
            <span class="n">hh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_medinv</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">gg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_medpt</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_medtp</span><span class="p">[</span><span class="n">binlist</span><span class="p">,</span> <span class="p">:]</span>

            <span class="c1"># estimate the histogram for the decade for invariants and pt</span>
            <span class="n">invhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                   <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                   <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>
            <span class="n">pthist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                  <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                  <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

            <span class="n">trhist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tr</span><span class="p">)]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                  <span class="n">bins</span><span class="o">=</span><span class="mi">360</span> <span class="o">/</span> <span class="n">bw</span><span class="p">,</span>
                                  <span class="nb">range</span><span class="o">=</span><span class="n">histrange</span><span class="p">)</span>

            <span class="c1">#--&gt; include the row for mean, median and mode for each parameter</span>
            <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">slistinv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
                <span class="n">slistinv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;median&#39;</span><span class="p">])</span>
                <span class="n">slistinv</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

                <span class="n">slistpt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
                <span class="n">slistpt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;median&#39;</span><span class="p">])</span>
                <span class="n">slistpt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

                <span class="n">slisttip</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
                <span class="n">slisttip</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;median&#39;</span><span class="p">])</span>
                <span class="n">slisttip</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;mode&#39;</span><span class="p">])</span>

            <span class="c1">#--&gt; compute mean, median and mode for invariants</span>
            <span class="c1"># == &gt; mean</span>
            <span class="n">imean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">imean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">imean</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># == &gt; median</span>
            <span class="n">imed</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">hh</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">hh</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">imed</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">imed</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># == &gt; mode</span>
            <span class="n">imode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">invhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">imode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">imode</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1">#--&gt; add them to the list of estimates</span>
            <span class="n">slistinv</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imean</span><span class="p">)</span>
            <span class="n">slistinv</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imed</span><span class="p">)</span>
            <span class="n">slistinv</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imode</span><span class="p">)</span>

            <span class="c1">#--&gt; compute pt statistics</span>
            <span class="c1"># == &gt; mean</span>
            <span class="n">ptmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">ptmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ptmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>

            <span class="c1"># == &gt; median</span>
            <span class="n">ptmed</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">gg</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">gg</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">ptmed</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ptmed</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># == &gt; mode</span>
            <span class="n">ptmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">pthist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">ptmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ptmode</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1">#--&gt; add the statistics to the parameter list</span>
            <span class="n">slistpt</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptmean</span><span class="p">)</span>
            <span class="n">slistpt</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptmed</span><span class="p">)</span>
            <span class="n">slistpt</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ptmode</span><span class="p">)</span>

            <span class="c1">#--&gt; compute tipper statistics</span>
            <span class="c1"># == &gt; mean</span>
            <span class="n">tpmean</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tipr</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">tpmean</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tpmean</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># == &gt; median</span>
            <span class="n">tpmed</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">tipr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">tipr</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">tpmed</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tpmed</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1"># == &gt; mode</span>
            <span class="n">tpmode</span> <span class="o">=</span> <span class="mi">90</span> <span class="o">-</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">trhist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">tpmode</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tpmode</span> <span class="o">+=</span> <span class="mi">360</span>

            <span class="c1">#--&gt; add the statistics to parameter list</span>
            <span class="n">slisttip</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tpmean</span><span class="p">)</span>
            <span class="n">slisttip</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tpmed</span><span class="p">)</span>
            <span class="n">slisttip</span><span class="p">[</span><span class="n">kk</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tpmode</span><span class="p">)</span>

        <span class="n">invfid</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">svpath</span><span class="p">,</span> <span class="s1">&#39;Strike.invariants&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">ptfid</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">svpath</span><span class="p">,</span> <span class="s1">&#39;Strike.pt&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">tpfid</span> <span class="o">=</span> <span class="n">file</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">svpath</span><span class="p">,</span> <span class="s1">&#39;Strike.tipper&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="c1">#---&gt; write strike from the invariants</span>
        <span class="c1"># == &gt; mean</span>
        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistinv</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># == &gt; median</span>
        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEDIAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistinv</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># == &gt; mode</span>
        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MODE&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistinv</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                         <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">invfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">invfid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1">#---&gt; write the phase tensor text files</span>
        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistpt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEDIAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistpt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MODE&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slistpt</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">ptfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ptfid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1">#---&gt; write the tipper text files</span>
        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slisttip</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MEDIAN&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slisttip</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;MODE&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">slisttip</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">l2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">l1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">jj</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:&gt;16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">6</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:^16}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="s1">&#39;</span><span class="si">{0: .2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l2</span><span class="p">)))</span>
            <span class="n">tpfid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">tpfid</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../master_doc.html">mtpy 1.01.01 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Geoscience Australia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
  </body>
</html>